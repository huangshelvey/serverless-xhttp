#!/usr/bin/env node

const _0xa45175=_0x2523;(function(_0x20f94d,_0x2a7fd2){const _0x42d37b=_0x2523,_0x1f2f02=_0x20f94d();while(!![]){try{const _0x4d4582=-parseInt(_0x42d37b(0x19b))/0x1*(parseInt(_0x42d37b(0x28a))/0x2)+-parseInt(_0x42d37b(0x176))/0x3*(parseInt(_0x42d37b(0x1b4))/0x4)+parseInt(_0x42d37b(0x196))/0x5+parseInt(_0x42d37b(0x1d9))/0x6+parseInt(_0x42d37b(0x1be))/0x7+-parseInt(_0x42d37b(0x1cf))/0x8+-parseInt(_0x42d37b(0x208))/0x9;if(_0x4d4582===_0x2a7fd2)break;else _0x1f2f02['push'](_0x1f2f02['shift']());}catch(_0x43e125){_0x1f2f02['push'](_0x1f2f02['shift']());}}}(_0x83f6,0xc3fc9));const _0xb9695f=(function(){let _0x36ef2e=!![];return function(_0x1c4c99,_0x288c8b){const _0x1785fb=_0x36ef2e?function(){const _0x33ed00=_0x2523;if(_0x288c8b){const _0x5d8965=_0x288c8b[_0x33ed00(0x26d)](_0x1c4c99,arguments);return _0x288c8b=null,_0x5d8965;}}:function(){};return _0x36ef2e=![],_0x1785fb;};}()),_0x3786b6=_0xb9695f(this,function(){const _0x3c3791=_0x2523;return _0x3786b6[_0x3c3791(0x172)]()[_0x3c3791(0x244)]('(((.+)+)+)+$')[_0x3c3791(0x172)]()['constructor'](_0x3786b6)[_0x3c3791(0x244)](_0x3c3791(0x27a));});_0x3786b6();const _0x202b9a=(function(){let _0x33df25=!![];return function(_0x4c2d12,_0x9bc6a7){const _0x247f8d=_0x33df25?function(){const _0xd3d002=_0x2523;if(_0x9bc6a7){const _0x12371c=_0x9bc6a7[_0xd3d002(0x26d)](_0x4c2d12,arguments);return _0x9bc6a7=null,_0x12371c;}}:function(){};return _0x33df25=![],_0x247f8d;};}()),_0x2f6334=_0x202b9a(this,function(){const _0x28b95d=_0x2523,_0x5893f2=function(){const _0x12a481=_0x2523;let _0x1f9c88;try{_0x1f9c88=Function(_0x12a481(0x2b0)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x30d031){_0x1f9c88=window;}return _0x1f9c88;},_0x1fda49=_0x5893f2(),_0x3fe820=_0x1fda49['console']=_0x1fda49[_0x28b95d(0x1c7)]||{},_0x3e3b08=[_0x28b95d(0x1d5),_0x28b95d(0x1df),_0x28b95d(0x1bd),_0x28b95d(0x235),'exception',_0x28b95d(0x1e2),_0x28b95d(0x2b1)];for(let _0x2f71b6=0x0;_0x2f71b6<_0x3e3b08[_0x28b95d(0x27f)];_0x2f71b6++){const _0x155096=_0x202b9a[_0x28b95d(0x250)][_0x28b95d(0x18d)]['bind'](_0x202b9a),_0x22e027=_0x3e3b08[_0x2f71b6],_0x518eab=_0x3fe820[_0x22e027]||_0x155096;_0x155096[_0x28b95d(0x194)]=_0x202b9a[_0x28b95d(0x1ac)](_0x202b9a),_0x155096['toString']=_0x518eab[_0x28b95d(0x172)][_0x28b95d(0x1ac)](_0x518eab),_0x3fe820[_0x22e027]=_0x155096;}});_0x2f6334();const os=require('os'),fs=require('fs'),net=require(_0xa45175(0x279)),dns=require('dns'),http=require(_0xa45175(0x169)),axios=require('axios'),{Buffer}=require(_0xa45175(0x21c)),{exec}=require(_0xa45175(0x1a8)),UUID=process['env'][_0xa45175(0x212)]||_0xa45175(0x166),NEZHA_SERVER=process[_0xa45175(0x1d4)][_0xa45175(0x181)]||'',NEZHA_PORT=process[_0xa45175(0x1d4)][_0xa45175(0x1e7)]||'',NEZHA_KEY=process[_0xa45175(0x1d4)][_0xa45175(0x286)]||'',AUTO_ACCESS=process[_0xa45175(0x1d4)][_0xa45175(0x2a9)]||!![],XPATH=process[_0xa45175(0x1d4)][_0xa45175(0x256)]||UUID[_0xa45175(0x21a)](0x0,0x8),SUB_PATH=process[_0xa45175(0x1d4)][_0xa45175(0x1dd)]||_0xa45175(0x29b),DOMAIN=process['env'][_0xa45175(0x2af)]||_0xa45175(0x22c),NAME=process['env']['NAME']||'',PORT=process[_0xa45175(0x1d4)][_0xa45175(0x249)]||0xbb8,SETTINGS={[_0xa45175(0x212)]:UUID,[_0xa45175(0x21b)]:_0xa45175(0x284),[_0xa45175(0x2ab)]:_0xa45175(0x25f),[_0xa45175(0x256)]:_0xa45175(0x28f)+XPATH,[_0xa45175(0x24d)]:0x32,[_0xa45175(0x16c)]:0x1e8480,[_0xa45175(0x22b)]:0x7530,[_0xa45175(0x1d3)]:0x40*0x400,[_0xa45175(0x29c)]:!![],['TCP_KEEPALIVE']:!![],[_0xa45175(0x1f4)]:0xea60,[_0xa45175(0x26a)]:0x493e0,[_0xa45175(0x1d2)]:0x64,[_0xa45175(0x1c6)]:0x40*0x400,[_0xa45175(0x1b5)]:0x40*0x400,[_0xa45175(0x215)]:0xa,[_0xa45175(0x178)]:![]},customDnsResolver={'servers':['1.1.1.1',_0xa45175(0x22f)],'currentServerIndex':0x0,async 'resolve'(_0x4fb401){const _0x468f72=_0xa45175,_0x5b88ae=this[_0x468f72(0x230)];let _0x26da0f;for(let _0x3cb25b=0x0;_0x3cb25b<_0x5b88ae[_0x468f72(0x27f)];_0x3cb25b++){const _0x5c0d94=(this[_0x468f72(0x1f9)]+_0x3cb25b)%_0x5b88ae[_0x468f72(0x27f)],_0x5b751d=_0x5b88ae[_0x5c0d94];try{log(_0x468f72(0x293),_0x468f72(0x2a2)+_0x4fb401+_0x468f72(0x292)+_0x5b751d);const _0x817b6a=await this[_0x468f72(0x260)](_0x4fb401,_0x5b751d);return this['currentServerIndex']=(_0x5c0d94+0x1)%_0x5b88ae[_0x468f72(0x27f)],log('debug',_0x468f72(0x214)+_0x4fb401+_0x468f72(0x1ab)+_0x817b6a+_0x468f72(0x29d)+_0x5b751d),_0x817b6a;}catch(_0x12a3f4){_0x26da0f=_0x12a3f4,log('warn',_0x468f72(0x224)+_0x5b751d+':\x20'+_0x12a3f4['message']);}}throw new Error(_0x468f72(0x231)+_0x26da0f?.['message']);},async 'resolveWithServer'(_0xefc2aa,_0x243b92){return new Promise((_0x6c1d94,_0x461317)=>{const _0x2e82a3=_0x2523,_0x3979e4=require(_0x2e82a3(0x210)),_0x3cb728=_0x3979e4[_0x2e82a3(0x1f5)]();_0x3979e4['setServers']([_0x243b92]),_0x3979e4[_0x2e82a3(0x1cb)](_0xefc2aa,(_0x50bf5c,_0x51c367)=>{const _0x4abde5=_0x2e82a3;_0x3979e4['setServers'](_0x3cb728);if(_0x50bf5c)_0x461317(_0x50bf5c);else _0x51c367&&_0x51c367[_0x4abde5(0x27f)]>0x0?_0x6c1d94(_0x51c367[0x0]):_0x461317(new Error(_0x4abde5(0x1da)));});});}};dns[_0xa45175(0x1e5)]('ipv4first'),dns[_0xa45175(0x282)](['1.1.1.1',_0xa45175(0x22f)]);function _0x2523(_0x3d2483,_0x1e8d85){const _0x2e14b4=_0x83f6();return _0x2523=function(_0x2f6334,_0x202b9a){_0x2f6334=_0x2f6334-0x166;let _0x4b7851=_0x2e14b4[_0x2f6334];return _0x4b7851;},_0x2523(_0x3d2483,_0x1e8d85);}function validate_uuid(_0x2c48fd,_0x2f3ebd){for(let _0x59d372=0x0;_0x59d372<0x10;_0x59d372++){if(_0x2c48fd[_0x59d372]!==_0x2f3ebd[_0x59d372])return![];}return!![];}function concat_typed_arrays(_0x3a2d92,..._0xe77835){const _0x5a7dcd=_0xa45175;if(!_0xe77835||_0xe77835[_0x5a7dcd(0x27f)]<0x1)return _0x3a2d92;let _0x3b01c5=_0x3a2d92[_0x5a7dcd(0x27f)];for(let _0x13946b of _0xe77835)_0x3b01c5+=_0x13946b[_0x5a7dcd(0x27f)];const _0x6c58b3=new _0x3a2d92[(_0x5a7dcd(0x250))](_0x3b01c5);_0x6c58b3[_0x5a7dcd(0x243)](_0x3a2d92,0x0),_0x3b01c5=_0x3a2d92[_0x5a7dcd(0x27f)];for(let _0x2a89f6 of _0xe77835){_0x6c58b3[_0x5a7dcd(0x243)](_0x2a89f6,_0x3b01c5),_0x3b01c5+=_0x2a89f6['length'];}return _0x6c58b3;}function log(_0x5c5082,..._0x5c04a7){const _0x31b495=_0xa45175;if(SETTINGS[_0x31b495(0x21b)]===_0x31b495(0x284))return;const _0x197c2c={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x1080ee={'debug':_0x31b495(0x1b6),'info':'\x1b[32m','warn':'\x1b[33m','error':'\x1b[31m','reset':_0x31b495(0x266)},_0x108ec2=_0x197c2c[SETTINGS[_0x31b495(0x21b)]]||0x1,_0x2ba78b=_0x197c2c[_0x5c5082]||0x0;if(_0x2ba78b>=_0x108ec2){const _0x5d0e48=new Date()[_0x31b495(0x223)](),_0x3fbf0d=_0x1080ee[_0x5c5082]||_0x1080ee[_0x31b495(0x268)];console[_0x31b495(0x1d5)](_0x3fbf0d+'['+_0x5d0e48+_0x31b495(0x19a)+_0x5c5082+']',..._0x5c04a7,_0x1080ee['reset']);}}const getDownloadUrl=()=>{const _0x522d14=_0xa45175,_0x3b2223=os[_0x522d14(0x229)]();return _0x3b2223===_0x522d14(0x1fb)||_0x3b2223===_0x522d14(0x242)||_0x3b2223===_0x522d14(0x1dc)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x522d14(0x299):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x522d14(0x19f);},downloadFile=async()=>{const _0x2a2424=_0xa45175;if(!NEZHA_KEY)return;try{const _0x333888=getDownloadUrl(),_0x3b1461=await axios({'method':_0x2a2424(0x16a),'url':_0x333888,'responseType':_0x2a2424(0x246)}),_0x17a627=fs[_0x2a2424(0x1a6)](_0x2a2424(0x27b));return _0x3b1461[_0x2a2424(0x216)]['pipe'](_0x17a627),new Promise((_0x44fd97,_0x580f08)=>{const _0x3fe473=_0x2a2424;_0x17a627['on'](_0x3fe473(0x2b2),()=>{const _0x2f590f=_0x3fe473;console[_0x2f590f(0x1d5)](_0x2f590f(0x295)),exec('chmod\x20+x\x20npm',_0x2029d3=>{if(_0x2029d3)_0x580f08(_0x2029d3);_0x44fd97();});}),_0x17a627['on']('error',_0x580f08);});}catch(_0x2bc47a){throw _0x2bc47a;}},runnz=async()=>{const _0x1c9dd7=_0xa45175;await downloadFile();let _0x599300='',_0xfc8340='';if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2f968c=[_0x1c9dd7(0x24a),_0x1c9dd7(0x1d1),_0x1c9dd7(0x1eb),'2087',_0x1c9dd7(0x19d),_0x1c9dd7(0x262)];_0x599300=_0x2f968c[_0x1c9dd7(0x219)](NEZHA_PORT)?_0x1c9dd7(0x298):'',_0xfc8340=_0x1c9dd7(0x182)+NEZHA_SERVER+':'+NEZHA_PORT+_0x1c9dd7(0x271)+NEZHA_KEY+'\x20'+_0x599300+_0x1c9dd7(0x1a9);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x34e50b=NEZHA_SERVER[_0x1c9dd7(0x219)](':')?NEZHA_SERVER[_0x1c9dd7(0x2aa)](':')[_0x1c9dd7(0x24f)]():'',_0x232dd1=new Set([_0x1c9dd7(0x24a),_0x1c9dd7(0x1d1),'2096',_0x1c9dd7(0x19c),_0x1c9dd7(0x19d),_0x1c9dd7(0x262)]),_0xe044e1=_0x232dd1['has'](_0x34e50b)?_0x1c9dd7(0x264):_0x1c9dd7(0x1e6),_0x1d3774=_0x1c9dd7(0x236)+NEZHA_KEY+_0x1c9dd7(0x2ae)+NEZHA_SERVER+_0x1c9dd7(0x222)+_0xe044e1+_0x1c9dd7(0x185)+UUID;fs['writeFileSync'](_0x1c9dd7(0x1cd),_0x1d3774);}_0xfc8340=_0x1c9dd7(0x253);}else return;}try{exec(_0xfc8340,{'shell':_0x1c9dd7(0x245)}),console[_0x1c9dd7(0x1d5)](_0x1c9dd7(0x1b7));}catch(_0x4db30f){console['error']('npm\x20running\x20error:\x20'+_0x4db30f);}};async function addAccessTask(){const _0x3a5e15=_0xa45175;if(AUTO_ACCESS!==!![])return;try{if(!DOMAIN)return;const _0x3335e4=_0x3a5e15(0x270)+DOMAIN,_0x2a0f92='curl\x20-X\x20POST\x20\x22https://oooo.serv00.net/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22'+_0x3335e4+_0x3a5e15(0x1c4);exec(_0x2a0f92,(_0x47b5ca,_0x55b7f4,_0x1c88f6)=>{const _0x3182f0=_0x3a5e15;if(_0x47b5ca){console[_0x3182f0(0x235)]('Error\x20sending\x20request:',_0x47b5ca['message']);return;}console[_0x3182f0(0x1d5)](_0x3182f0(0x1aa),_0x55b7f4);});}catch(_0x2ca570){console[_0x3a5e15(0x235)]('Error\x20added\x20Task:',_0x2ca570[_0x3a5e15(0x198)]);}}function parse_uuid(_0x30586a){const _0xfc913b=_0xa45175;_0x30586a=_0x30586a[_0xfc913b(0x192)]('-','');const _0x1a2b95=[];for(let _0x18adda=0x0;_0x18adda<0x10;_0x18adda++){_0x1a2b95[_0xfc913b(0x26f)](parseInt(_0x30586a[_0xfc913b(0x259)](_0x18adda*0x2,0x2),0x10));}return _0x1a2b95;}async function read_vless_header(_0x4bad67,_0x35ea2b){const _0x476d59=_0xa45175;let _0x2214f1=0x0,_0x3fb809=new Uint8Array(),_0x597954={'value':_0x3fb809,'done':![]};async function _0x5a2a7d(_0x2bc1c2){const _0x2f9f03=_0x2523;if(_0x597954[_0x2f9f03(0x228)])throw new Error(_0x2f9f03(0x202));const _0x3e09b2=_0x2bc1c2-_0x2214f1;if(_0x3e09b2<0x1)return;_0x597954=await read_atleast(_0x4bad67,_0x3e09b2),_0x2214f1+=_0x597954[_0x2f9f03(0x20d)][_0x2f9f03(0x27f)],_0x3fb809=concat_typed_arrays(_0x3fb809,_0x597954[_0x2f9f03(0x20d)]);}await _0x5a2a7d(0x1+0x10+0x1);const _0x4842fa=_0x3fb809[0x0],_0xa7c313=_0x3fb809[_0x476d59(0x21a)](0x1,0x1+0x10),_0xeb286=parse_uuid(_0x35ea2b);if(!validate_uuid(_0xa7c313,_0xeb286))throw new Error(_0x476d59(0x23e));const _0xc99141=_0x3fb809[0x1+0x10],_0x4b64af=0x1+0x10+0x1+_0xc99141+0x1+0x2+0x1;await _0x5a2a7d(_0x4b64af+0x1);const _0x376e70=_0x3fb809[0x1+0x10+0x1+_0xc99141],_0x494d39=0x1;if(_0x376e70!==_0x494d39)throw new Error('unsupported\x20command:\x20'+_0x376e70);const _0x4b3d9d=(_0x3fb809[_0x4b64af-0x1-0x2]<<0x8)+_0x3fb809[_0x4b64af-0x1-0x1],_0x277b1e=_0x3fb809[_0x4b64af-0x1],_0xdd990=0x1,_0x26b44a=0x2,_0x1774a8=0x3;let _0x2202b4=-0x1;if(_0x277b1e===_0xdd990)_0x2202b4=_0x4b64af+0x4;else{if(_0x277b1e===_0x1774a8)_0x2202b4=_0x4b64af+0x10;else _0x277b1e===_0x26b44a&&(_0x2202b4=_0x4b64af+0x1+_0x3fb809[_0x4b64af]);}if(_0x2202b4<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x5a2a7d(_0x2202b4);const _0x4a99f9=_0x4b64af;let _0x109598='';if(_0x277b1e===_0xdd990)_0x109598=_0x3fb809[_0x476d59(0x21a)](_0x4a99f9,_0x4a99f9+0x4)[_0x476d59(0x283)]('.');else{if(_0x277b1e===_0x26b44a)_0x109598=new TextDecoder()[_0x476d59(0x1fa)](_0x3fb809[_0x476d59(0x21a)](_0x4a99f9+0x1,_0x4a99f9+0x1+_0x3fb809[_0x4a99f9]));else _0x277b1e===_0x1774a8&&(_0x109598=_0x3fb809[_0x476d59(0x21a)](_0x4a99f9,_0x4a99f9+0x10)[_0x476d59(0x213)]((_0x56c7ec,_0x5a7aa7,_0x399958,_0x3f7495)=>_0x399958%0x2?_0x56c7ec[_0x476d59(0x168)](((_0x3f7495[_0x399958-0x1]<<0x8)+_0x5a7aa7)[_0x476d59(0x172)](0x10)):_0x56c7ec,[])['join'](':'));}if(!_0x109598){log('error',_0x476d59(0x285));throw new Error('parse\x20hostname\x20failed');}return log(_0x476d59(0x1bd),_0x476d59(0x1ba)+_0x109598+':'+_0x4b3d9d),{'hostname':_0x109598,'port':_0x4b3d9d,'data':_0x3fb809[_0x476d59(0x21a)](_0x2202b4),'resp':new Uint8Array([_0x4842fa,0x0])};}async function read_atleast(_0x2646f5,_0x1e592f){const _0x419169=_0xa45175,_0x198b37=[];let _0x340895=![];while(_0x1e592f>0x0&&!_0x340895){const _0x5effb4=await _0x2646f5['read']();if(_0x5effb4['value']){const _0x435b3f=new Uint8Array(_0x5effb4[_0x419169(0x20d)]);_0x198b37[_0x419169(0x26f)](_0x435b3f),_0x1e592f-=_0x435b3f[_0x419169(0x27f)];}_0x340895=_0x5effb4[_0x419169(0x228)];}if(_0x1e592f>0x0)throw new Error('not\x20enough\x20data\x20to\x20read');return{'value':concat_typed_arrays(..._0x198b37),'done':_0x340895};}async function parse_header(_0x5d705d,_0x3c4a68){const _0x8561cf=_0xa45175;log(_0x8561cf(0x293),_0x8561cf(0x265));const _0x133a98=_0x3c4a68[_0x8561cf(0x20c)]['getReader']();try{const _0x3b2392=await read_vless_header(_0x133a98,_0x5d705d);return log(_0x8561cf(0x293),_0x8561cf(0x2a4)),_0x3b2392;}catch(_0x387dc7){log(_0x8561cf(0x235),_0x8561cf(0x1f6)+_0x387dc7['message']);throw new Error(_0x8561cf(0x25c)+_0x387dc7[_0x8561cf(0x198)]);}finally{_0x133a98[_0x8561cf(0x29f)]();}}async function connect_remote(_0x43ccd1,_0x3e8f8b){const _0x43ff23=_0xa45175,_0xb5b6aa=0x2710;try{let _0x5c428b=_0x43ccd1;if(!/^\d+\.\d+\.\d+\.\d+$/[_0x43ff23(0x1ed)](_0x43ccd1)&&!_0x43ccd1[_0x43ff23(0x2b6)]('['))try{_0x5c428b=await customDnsResolver[_0x43ff23(0x195)](_0x43ccd1),log(_0x43ff23(0x293),'DNS\x20resolved\x20'+_0x43ccd1+_0x43ff23(0x1ab)+_0x5c428b);}catch(_0x119e76){log(_0x43ff23(0x1df),'DNS\x20resolution\x20failed\x20for\x20'+_0x43ccd1+_0x43ff23(0x22d)+_0x119e76['message']);}const _0x488dd6=await timed_connect(_0x5c428b,_0x3e8f8b,_0xb5b6aa);return _0x488dd6[_0x43ff23(0x1b0)](SETTINGS['TCP_NODELAY']),_0x488dd6[_0x43ff23(0x1b8)](SETTINGS[_0x43ff23(0x240)],0x3e8),_0x488dd6[_0x43ff23(0x189)]&&_0x488dd6[_0x43ff23(0x189)](SETTINGS['READ_BUFFER_SIZE']),_0x488dd6['setWriteBuffer']&&_0x488dd6['setWriteBuffer'](SETTINGS['WRITE_BUFFER_SIZE']),_0x488dd6[_0x43ff23(0x209)]&&_0x488dd6['_handle']['setNoDelay']&&_0x488dd6[_0x43ff23(0x209)][_0x43ff23(0x1b0)](!![]),log(_0x43ff23(0x1bd),_0x43ff23(0x1c5)+_0x43ccd1+'('+_0x5c428b+'):'+_0x3e8f8b+_0x43ff23(0x1a7)),_0x488dd6;}catch(_0xb1df98){log('error',_0x43ff23(0x255)+_0xb1df98[_0x43ff23(0x198)]);throw _0xb1df98;}}function timed_connect(_0x45b19a,_0x40fc7a,_0x4324a5){return new Promise((_0x3c1cd8,_0x46edaf)=>{const _0xac2291=net['createConnection']({'host':_0x45b19a,'port':_0x40fc7a}),_0x2899de=setTimeout(()=>{const _0x4ffcaf=_0x2523;_0x46edaf(new Error(_0x4ffcaf(0x175)));},_0x4324a5);_0xac2291['on']('connect',()=>{clearTimeout(_0x2899de),_0x3c1cd8(_0xac2291);}),_0xac2291['on']('error',_0x4bac27=>{clearTimeout(_0x2899de),_0x46edaf(_0x4bac27);});});}function pipe_relay(){async function _0x39b907(_0x12fc71,_0x304c06,_0x386206){const _0x3a3a3f=_0x2523,_0x36ec2a=SETTINGS[_0x3a3a3f(0x1d3)];let _0x3dad04=0x0;const _0xc5af61=Date[_0x3a3a3f(0x16d)]();if(_0x386206[_0x3a3a3f(0x27f)]>0x0){if(_0x304c06[_0x3a3a3f(0x1b1)])_0x304c06[_0x3a3a3f(0x275)](),_0x304c06['write'](_0x386206),process[_0x3a3a3f(0x2a6)](()=>_0x304c06[_0x3a3a3f(0x252)]()),_0x3dad04+=_0x386206[_0x3a3a3f(0x27f)];else{const _0x4a2b43=_0x304c06['writable'][_0x3a3a3f(0x226)]();try{await _0x4a2b43[_0x3a3a3f(0x1b1)](_0x386206),_0x3dad04+=_0x386206['length'];}finally{_0x4a2b43[_0x3a3a3f(0x29f)]();}}}try{if(_0x12fc71[_0x3a3a3f(0x2a7)]){_0x12fc71['pause'](),_0x12fc71[_0x3a3a3f(0x296)][_0x3a3a3f(0x1ce)]=_0x36ec2a;_0x304c06[_0x3a3a3f(0x221)]&&(_0x304c06[_0x3a3a3f(0x221)]['highWaterMark']=_0x36ec2a);const {Transform:_0x2301e1}=require(_0x3a3a3f(0x246)),_0x28d34d=new _0x2301e1({'transform'(_0x516f61,_0x4af68c,_0x5dc25b){const _0x2e86fc=_0x3a3a3f;_0x3dad04+=_0x516f61[_0x2e86fc(0x27f)],_0x516f61[_0x2e86fc(0x27f)]<0x400?this[_0x2e86fc(0x26f)](_0x516f61):this[_0x2e86fc(0x26f)](_0x516f61),_0x5dc25b();},'highWaterMark':_0x36ec2a});_0x12fc71[_0x3a3a3f(0x2a7)](_0x28d34d)[_0x3a3a3f(0x2a7)](_0x304c06,{'end':!![],'highWaterMark':_0x36ec2a}),_0x12fc71['resume']();}else{const _0x44e19c=_0x12fc71[_0x3a3a3f(0x20c)][_0x3a3a3f(0x1fc)](),_0x167417=_0x304c06[_0x3a3a3f(0x18a)][_0x3a3a3f(0x226)]();try{while(!![]){const {done:_0x2e6805,value:_0x44ad5f}=await _0x44e19c['read']();if(_0x2e6805)break;_0x3dad04+=_0x44ad5f[_0x3a3a3f(0x27f)],await _0x167417[_0x3a3a3f(0x1b1)](_0x44ad5f);}}finally{_0x44e19c[_0x3a3a3f(0x29f)](),_0x167417[_0x3a3a3f(0x29f)]();}}const _0x1d39b9=Date['now']()-_0xc5af61;if(_0x3dad04>0x0&&_0x1d39b9>0x0){const _0x230b92=Math[_0x3a3a3f(0x1d6)](_0x3dad04/_0x1d39b9*0x3e8/0x400);log('debug',_0x3a3a3f(0x220)+_0x3dad04+_0x3a3a3f(0x29a)+_0x1d39b9+_0x3a3a3f(0x1bb)+_0x230b92+_0x3a3a3f(0x26c));}}catch(_0x7277ae){!_0x7277ae[_0x3a3a3f(0x198)][_0x3a3a3f(0x219)](_0x3a3a3f(0x1e4))&&log('error',_0x3a3a3f(0x227),_0x7277ae['message']);throw _0x7277ae;}}return _0x39b907;}function socketToWebStream(_0x1b68d0,_0x144d3b){const _0x41c5f2=_0xa45175;let _0x42e550,_0x49002c,_0x4ce39b=![];const _0x5e5d4b=_0x5373bd=>{const _0x29e418=_0x2523;if(_0x4ce39b)return;log('error',_0x29e418(0x1bf),_0x5373bd[_0x29e418(0x198)]),_0x42e550?.[_0x29e418(0x235)](_0x5373bd),_0x49002c?.['error'](_0x5373bd);},_0x29fe9d=_0x369fb3=>{const _0x450535=_0x2523;if(_0x4ce39b)return;try{_0x42e550?.[_0x450535(0x1ad)](_0x369fb3);}catch(_0x4444f9){log(_0x450535(0x235),'Read\x20controller\x20error:',_0x4444f9[_0x450535(0x198)]);}},_0xf5c13f=()=>{const _0xc7307f=_0x2523;if(_0x4ce39b)return;try{_0x42e550?.[_0xc7307f(0x238)]();}catch(_0x167256){log('error',_0xc7307f(0x25e),_0x167256['message']);}};return _0x1b68d0['on']('error',_0x5e5d4b),_0x1b68d0['on']('data',_0x29fe9d),_0x1b68d0['on'](_0x41c5f2(0x277),_0xf5c13f),_0x144d3b&&(_0x144d3b[_0x41c5f2(0x17d)][_0x41c5f2(0x1f0)](_0x41c5f2(0x235)),_0x144d3b[_0x41c5f2(0x17d)][_0x41c5f2(0x1f0)](_0x41c5f2(0x216)),_0x144d3b[_0x41c5f2(0x17d)]['add'](_0x41c5f2(0x277))),{'readable':new ReadableStream({'start'(_0x26587e){_0x42e550=_0x26587e;},'cancel'(){const _0x25ecd6=_0x41c5f2;_0x4ce39b=!![],_0x1b68d0[_0x25ecd6(0x1f7)](_0x25ecd6(0x235),_0x5e5d4b),_0x1b68d0[_0x25ecd6(0x1f7)](_0x25ecd6(0x216),_0x29fe9d),_0x1b68d0[_0x25ecd6(0x1f7)](_0x25ecd6(0x277),_0xf5c13f),_0x1b68d0[_0x25ecd6(0x28d)]();}}),'writable':new WritableStream({'start'(_0x36ef4d){_0x49002c=_0x36ef4d;},'write'(_0x28d89a){return new Promise((_0x3d6724,_0x30078a)=>{const _0x3cf18a=_0x2523;if(_0x1b68d0['destroyed']||_0x4ce39b){_0x30078a(new Error(_0x3cf18a(0x18e)));return;}_0x1b68d0[_0x3cf18a(0x1b1)](_0x28d89a,_0x165209=>{if(_0x165209)_0x30078a(_0x165209);else _0x3d6724();});});},'close'(){const _0x4304c5=_0x41c5f2;_0x4ce39b=!![],_0x1b68d0[_0x4304c5(0x1f7)]('error',_0x5e5d4b),_0x1b68d0[_0x4304c5(0x1f7)](_0x4304c5(0x216),_0x29fe9d),_0x1b68d0[_0x4304c5(0x1f7)](_0x4304c5(0x277),_0xf5c13f),!_0x1b68d0[_0x4304c5(0x1a0)]&&_0x1b68d0[_0x4304c5(0x277)]();},'abort'(_0x23e0af){const _0x2c2e01=_0x41c5f2;_0x4ce39b=!![],_0x1b68d0[_0x2c2e01(0x1f7)](_0x2c2e01(0x235),_0x5e5d4b),_0x1b68d0['removeListener']('data',_0x29fe9d),_0x1b68d0[_0x2c2e01(0x1f7)](_0x2c2e01(0x277),_0xf5c13f),_0x1b68d0[_0x2c2e01(0x28d)](_0x23e0af);}})};}function relay(_0x5bf272,_0x10cf44,_0x54714f,_0x42c0a9,_0x13f089){const _0x423d69=_0xa45175,_0x17eef1=pipe_relay();let _0x31d5fb=![];const _0x1867ba=socketToWebStream(_0x54714f,_0x13f089);function _0x3fcc90(){const _0x169fa4=_0x2523;if(!_0x31d5fb){_0x31d5fb=!![];try{_0x54714f[_0x169fa4(0x28d)]();}catch(_0x409b1c){!_0x409b1c[_0x169fa4(0x198)][_0x169fa4(0x219)](_0x169fa4(0x1e4))&&!_0x409b1c['message'][_0x169fa4(0x219)]('socket\x20hang\x20up')&&log(_0x169fa4(0x235),'Cleanup\x20error:\x20'+_0x409b1c[_0x169fa4(0x198)]);}}}const _0x4583c7=_0x17eef1(_0x10cf44,_0x1867ba,_0x42c0a9[_0x423d69(0x216)])[_0x423d69(0x225)](_0x53f05c=>{const _0x51c7d9=_0x423d69;!_0x53f05c[_0x51c7d9(0x198)]['includes'](_0x51c7d9(0x1e4))&&!_0x53f05c['message'][_0x51c7d9(0x219)]('socket\x20hang\x20up')&&log('error',_0x51c7d9(0x190)+_0x53f05c[_0x51c7d9(0x198)]);})[_0x423d69(0x170)](()=>{const _0x308ac4=_0x423d69;_0x10cf44[_0x308ac4(0x171)]&&_0x10cf44[_0x308ac4(0x171)]();}),_0x508e3b=_0x17eef1(_0x1867ba,_0x10cf44,_0x42c0a9[_0x423d69(0x297)])['catch'](_0x22b745=>{const _0xbe6367=_0x423d69;!_0x22b745[_0xbe6367(0x198)][_0xbe6367(0x219)](_0xbe6367(0x1e4))&&!_0x22b745[_0xbe6367(0x198)]['includes'](_0xbe6367(0x257))&&log('error',_0xbe6367(0x17c)+_0x22b745[_0xbe6367(0x198)]);});_0x508e3b['finally'](()=>_0x4583c7)[_0x423d69(0x170)](_0x3fcc90);}const sessions=new Map();function cleanupExpiredSessions(){const _0x563b8f=_0xa45175,_0x3b6994=Date[_0x563b8f(0x16d)](),_0xaccaa=[];for(const [_0xd565c4,_0x2915ee]of sessions){_0x3b6994-_0x2915ee[_0x563b8f(0x1b2)]>SETTINGS['MAX_SESSION_AGE']&&_0xaccaa['push'](_0xd565c4);}for(const _0x15b5c6 of _0xaccaa){const _0xbb0c6=sessions['get'](_0x15b5c6);_0xbb0c6&&(log(_0x563b8f(0x293),_0x563b8f(0x1f3)+_0x15b5c6),_0xbb0c6[_0x563b8f(0x1b9)]());}_0xaccaa['length']>0x0&&log(_0x563b8f(0x1bd),'Cleaned\x20up\x20'+_0xaccaa[_0x563b8f(0x27f)]+_0x563b8f(0x17e));}function _0x83f6(){const _0x1352e6=['unlink',']\x20[','199wcVbBq','2087','2083','clear','https://amd64.ssss.nyc.mn/agent','destroyed','all','Error\x20writing\x20to\x20client:\x20','HTTP\x20Hijacking\x20not\x20supported','activeConnections','Server\x20info:\x20IP=','createWriteStream','\x20with\x20optimized\x20settings','child_process','\x20>/dev/null\x202>&1\x20&','Automatic\x20Access\x20Task\x20added\x20successfully:','\x20to\x20','bind','enqueue','&sni=','Processing\x20packet:\x20seq=','setNoDelay','write','lastActivity','s,\x20Transferred:\x20','8vCfUsM','READ_BUFFER_SIZE','\x1b[36m','npm\x20is\x20running','setKeepAlive','cleanup','VLS\x20connection\x20to\x20','ms\x20(','headersSent','info','10877013phBqvC','Socket\x20error:','writeHead','GET,\x20POST','http/1.1','removeAllListeners','\x22}\x27','Connected\x20to\x20','WRITE_BUFFER_SIZE','console','replace','downstreamStarted','headersTimeout','resolve4','requestTimeout','config.yaml','highWaterMark','6616560YBAhMk','Server\x20error:\x20','8443','CONNECTION_POOL_SIZE','CHUNK_SIZE','env','log','round','size','Connection:\x20close\x0d\x0a','233916bnILDD','No\x20addresses\x20found','Error\x20writing\x20to\x20remote:\x20','aarch64','SUB_PATH','\x20bytes','warn','uuid','Remote\x20connection\x20error:\x20','table','\x20-\x20Duration:\x20','aborted','setDefaultResultOrder','false','NEZHA_PORT','country_code','New\x20secure\x20connection\x20using:\x20','cleaned','2096','responseHeader','test','currentStreamRes','MB,\x20RSS\x20','add','initialized','\x20from\x20','Cleaning\x20up\x20expired\x20session:\x20','SESSION_CLEANUP_INTERVAL','getServers','VLESS\x20header\x20parse\x20error:\x20','removeListener','keys','currentServerIndex','decode','arm','getReader','MB)','totalConnections','Failed\x20to\x20write\x20HTTP\x20response:\x20','Failed\x20to\x20write\x20to\x20remote:\x20','initializeVLESS','header\x20length\x20too\x20short','Unknown','then','Remote\x20error:\x20','hostname','https://api.ip.sb/geoip','7073316tUVLBJ','_handle','tls','MB,\x20Sessions:\x20','readable','value','MB,\x20forcing\x20garbage\x20collection','timeout','dns','fill','UUID','reduce','Resolved\x20','BATCH_PROCESS_SIZE','data','_processPendingPackets',',\x20Active:\x20','includes','slice','LOG_LEVEL','buffer','vlessHeader','Failed\x20to\x20get\x20server\x20info:\x20','MB\x20(freed\x20','Transfer\x20completed:\x20','_writableState','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','toISOString','DNS\x20resolution\x20failed\x20with\x20','catch','getWriter','Relay\x20error:','done','arch','setTimeout','SESSION_TIMEOUT','ren-hsw.onrender.com',',\x20using\x20original\x20hostname:\x20','s,\x20Connections:\x20','8.8.8.8','servers','All\x20DNS\x20servers\x20failed.\x20Last\x20error:\x20','HTTP/1.1\x20200\x20OK\x0d\x0a','Got\x20IPv6\x20address:\x20','totalBytesTransferred','error','\x0aclient_secret:\x20','_writeToRemote','close','Session\x20initialization\x20timeout\x20for:\x20','Hello,\x20World\x0a','Process\x20packet\x20error:\x20','Performance\x20Stats\x20-\x20Uptime:\x20','Client\x20connection\x20error\x20for\x20session:\x20','invalid\x20UUID','heapUsed','TCP_KEEPALIVE','url','arm64','set','search','/bin/bash','stream','&alpn=h2%2Chttp%2F1.1&fp=chrome&allowInsecure=1&type=xhttp&host=','Client\x20connection\x20closed','PORT','443','keepAliveTimeout','vless://','MAX_BUFFERED_POSTS','writableEnded','pop','constructor','cleanupTimer','uncork','nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','sort','Connection\x20failed:\x20','XPATH','socket\x20hang\x20up','forEach','substr','Failed\x20to\x20initialize\x20VLESS:\x20','https://ipv6.ip.sb','read\x20vless\x20header\x20error:\x20','remote','Read\x20controller\x20close\x20error:','8192','resolveWithServer','Created\x20new\x20session\x20for\x20GET:\x20','2053','Failed\x20to\x20get\x20IP\x20from\x20','true','Starting\x20to\x20parse\x20VLESS\x20header','\x1b[0m','headerSent','reset','text/plain','MAX_SESSION_AGE','secureConnection','\x20KB/s)','apply','socket','push','https://','\x20-p\x20','random','Failed\x20to\x20write\x20VLESS\x20response:\x20','nextSeq','cork','bufferedData','end','from','net','(((.+)+)+)+$','npm','POST','Session\x20','):\x20','length','KB,\x20Speed:\x20','Error\x20starting\x20downstream:\x20','setServers','join','none','Failed\x20to\x20parse\x20hostname','NEZHA_KEY','?encryption=none&security=','Remote\x20connection\x20not\x20available','Failed\x20to\x20get\x20ISP\x20info:\x20','2722fKJpRi','https://ipv4.ip.sb','IPv6\x20fallback\x20failed:','destroy','trim','%2F','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet','Too\x20many\x20buffered\x20packets','\x20using\x20DNS\x20server:\x20','debug','Content-Type:\x20application/octet-stream\x0d\x0a','npm\x20download\x20successfully','_readableState','resp','--tls','https://arm64.ssss.nyc.mn/agent','\x20bytes\x20in\x20','ray','TCP_NODELAY','\x20using\x20','pendingBuffers','releaseLock','Unknown_ISP','Sent\x20HTTP\x20response\x20header\x20for\x20session:\x20','Resolving\x20','_startDownstreamResponse','VLESS\x20header\x20parsed\x20successfully','Sent\x20VLESS\x20response\x20header\x20for\x20session:\x20','nextTick','pipe','Buffered\x20packet\x20seq=','AUTO_ACCESS','split','BUFFER_SIZE','upgrade','VLESS\x20header\x20parsed:\x20','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','DOMAIN','return\x20(function()\x20','trace','finish','startDownstream','ISP\x20info\x20obtained:\x20',',\x20size=','startsWith','60f86c80-cc31-47a3-aa65-de346801fc1f','Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36','concat','http','get','alpnProtocol','MAX_POST_SIZE','now','floor','HTTP\x20upgrade\x20request\x20received','finally','reading_done','toString','delete','setWriteBuffer','connect\x20timeout','582789bPyyUK','base64','ENABLE_COMPRESSION','processPacket','method','startTime','Download\x20error:\x20','eventListeners','\x20expired\x20sessions','Server\x20is\x20running\x20on\x20port\x20','memoryUsage','NEZHA_SERVER','nohup\x20./npm\x20-s\x20','port',',\x20ISP=','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','peakMemoryUsage','&path=','localhost','setReadBuffer','writable','https://ipinfo.io/ip','pendingPackets','prototype','Socket\x20is\x20destroyed','bytesTransferred','Upload\x20error:\x20','maxConnections','replaceAll','KB/s','__proto__','resolve','7411375LMtstX','Sending\x20VLESS\x20response\x20header\x20(','message'];_0x83f6=function(){return _0x1352e6;};return _0x83f6();}setInterval(cleanupExpiredSessions,SETTINGS['SESSION_CLEANUP_INTERVAL']);const performanceStats={'totalConnections':0x0,'activeConnections':0x0,'totalBytesTransferred':0x0,'averageSpeed':0x0,'peakMemoryUsage':0x0,'startTime':Date['now']()};function monitorMemory(){const _0x59c8b7=_0xa45175,_0x36a8cb=process['memoryUsage'](),_0x32b081=Math[_0x59c8b7(0x1d6)](_0x36a8cb[_0x59c8b7(0x23f)]/0x400/0x400),_0x13b91d=Math[_0x59c8b7(0x1d6)](_0x36a8cb['rss']/0x400/0x400);performanceStats['peakMemoryUsage']=Math['max'](performanceStats[_0x59c8b7(0x186)],_0x32b081);const _0x5d9e68=Math[_0x59c8b7(0x1d6)]((Date[_0x59c8b7(0x16d)]()-performanceStats[_0x59c8b7(0x17b)])/0x3e8),_0x248cbc=performanceStats[_0x59c8b7(0x234)]>0x0?Math['round'](performanceStats[_0x59c8b7(0x234)]/_0x5d9e68/0x400):0x0;log(_0x59c8b7(0x293),'Memory:\x20Heap\x20'+_0x32b081+_0x59c8b7(0x1ef)+_0x13b91d+_0x59c8b7(0x20b)+sessions[_0x59c8b7(0x1d7)]+',\x20Speed:\x20'+_0x248cbc+_0x59c8b7(0x193));if(_0x32b081>0x1f4){log(_0x59c8b7(0x1df),'High\x20memory\x20usage\x20detected:\x20'+_0x32b081+_0x59c8b7(0x20e));if(global['gc']){global['gc']();const _0x371ffb=process[_0x59c8b7(0x180)](),_0xf0c4ee=Math[_0x59c8b7(0x1d6)](_0x371ffb[_0x59c8b7(0x23f)]/0x400/0x400);log('info','After\x20GC:\x20'+_0xf0c4ee+_0x59c8b7(0x21f)+(_0x32b081-_0xf0c4ee)+_0x59c8b7(0x1fd));}}}function logPerformanceStats(){const _0x435a2c=_0xa45175,_0x5d37df=Math[_0x435a2c(0x1d6)]((Date[_0x435a2c(0x16d)]()-performanceStats[_0x435a2c(0x17b)])/0x3e8),_0x5534cf=performanceStats[_0x435a2c(0x234)]>0x0?Math[_0x435a2c(0x1d6)](performanceStats[_0x435a2c(0x234)]/_0x5d37df/0x400):0x0;log(_0x435a2c(0x1bd),_0x435a2c(0x23c)+_0x5d37df+_0x435a2c(0x22e)+performanceStats[_0x435a2c(0x1fe)]+_0x435a2c(0x218)+sessions[_0x435a2c(0x1d7)]+',\x20Transferred:\x20'+Math[_0x435a2c(0x1d6)](performanceStats[_0x435a2c(0x234)]/0x400/0x400)+'MB,\x20Avg\x20Speed:\x20'+_0x5534cf+'KB/s,\x20Peak\x20Memory:\x20'+performanceStats[_0x435a2c(0x186)]+'MB');}setInterval(monitorMemory,0x7530),setInterval(logPerformanceStats,0x493e0);class Session{constructor(_0x37a939){const _0x16e792=_0xa45175;this[_0x16e792(0x1e0)]=_0x37a939,this[_0x16e792(0x274)]=0x0,this['downstreamStarted']=![],this[_0x16e792(0x1b2)]=Date['now'](),this['vlessHeader']=null,this[_0x16e792(0x25d)]=null,this[_0x16e792(0x1f1)]=![],this[_0x16e792(0x1ec)]=null,this['headerSent']=![],this[_0x16e792(0x276)]=new Map(),this[_0x16e792(0x1ea)]=![],this[_0x16e792(0x18c)]=[],this[_0x16e792(0x1ee)]=null,this['pendingBuffers']=new Map(),this['cleanupTimer']=null,this['eventListeners']=new Set(),this['bytesTransferred']=0x0,this[_0x16e792(0x17b)]=Date[_0x16e792(0x16d)](),log('debug','Created\x20new\x20session\x20with\x20UUID:\x20'+_0x37a939),performanceStats[_0x16e792(0x1fe)]++,performanceStats[_0x16e792(0x1a4)]++,this[_0x16e792(0x251)]=setTimeout(()=>{const _0x52dae6=_0x16e792;this[_0x52dae6(0x1b9)]();},SETTINGS['MAX_SESSION_AGE']);}async[_0xa45175(0x201)](_0x19e112){const _0x434393=_0xa45175;if(this[_0x434393(0x1f1)])return!![];try{log(_0x434393(0x293),_0x434393(0x290));const _0x2d4218=new ReadableStream({'start'(_0x49a2ca){const _0xb6c6b9=_0x434393;_0x49a2ca[_0xb6c6b9(0x1ad)](_0x19e112),_0x49a2ca['close']();}}),_0x14e87e={'readable':_0x2d4218,'writable':new WritableStream()};return this[_0x434393(0x21d)]=await parse_header(SETTINGS[_0x434393(0x212)],_0x14e87e),log(_0x434393(0x1bd),_0x434393(0x2ad)+this[_0x434393(0x21d)][_0x434393(0x206)]+':'+this['vlessHeader'][_0x434393(0x183)]),this[_0x434393(0x25d)]=await connect_remote(this[_0x434393(0x21d)][_0x434393(0x206)],this['vlessHeader'][_0x434393(0x183)]),log(_0x434393(0x1bd),'Remote\x20connection\x20established'),this['initialized']=!![],!![];}catch(_0x490e9b){return log('error',_0x434393(0x25a)+_0x490e9b['message']),![];}}async['processPacket'](_0x522095,_0x56b83){const _0x2640b8=_0xa45175;try{this[_0x2640b8(0x1b2)]=Date[_0x2640b8(0x16d)](),this[_0x2640b8(0x29e)][_0x2640b8(0x243)](_0x522095,_0x56b83),log('debug',_0x2640b8(0x2a8)+_0x522095+',\x20size='+_0x56b83[_0x2640b8(0x27f)]);if(_0x522095===0x0&&!this[_0x2640b8(0x1f1)]){const _0x246ede=this[_0x2640b8(0x29e)][_0x2640b8(0x16a)](0x0);this['pendingBuffers'][_0x2640b8(0x173)](0x0);if(!await this['initializeVLESS'](_0x246ede))throw new Error('Failed\x20to\x20initialize\x20VLESS\x20connection');return this['responseHeader']=Buffer[_0x2640b8(0x278)]([0x0,0x0]),await this[_0x2640b8(0x237)](this['vlessHeader'][_0x2640b8(0x216)]),await this[_0x2640b8(0x217)](),!![];}if(this[_0x2640b8(0x1f1)])return await this[_0x2640b8(0x237)](_0x56b83),!![];if(!this[_0x2640b8(0x1f1)])return log(_0x2640b8(0x293),'Waiting\x20for\x20initialization,\x20buffering\x20packet\x20seq='+_0x522095),!![];if(this[_0x2640b8(0x29e)]['size']>SETTINGS[_0x2640b8(0x24d)])throw new Error(_0x2640b8(0x291));return!![];}catch(_0x43e7f3){log(_0x2640b8(0x235),_0x2640b8(0x23b)+_0x43e7f3[_0x2640b8(0x198)]);throw _0x43e7f3;}}async[_0xa45175(0x217)](){const _0x16a283=_0xa45175,_0x2614af=Array[_0x16a283(0x278)](this[_0x16a283(0x29e)][_0x16a283(0x1f8)]())[_0x16a283(0x254)]((_0x930478,_0x17fe67)=>_0x930478-_0x17fe67);for(const _0x1136b0 of _0x2614af){if(_0x1136b0>0x0){const _0x211221=this['pendingBuffers'][_0x16a283(0x16a)](_0x1136b0);this[_0x16a283(0x29e)]['delete'](_0x1136b0),this[_0x16a283(0x1f1)]&&(await this[_0x16a283(0x237)](_0x211221),log(_0x16a283(0x293),'Processed\x20pending\x20packet\x20seq='+_0x1136b0));}}}['_startDownstreamResponse'](){const _0x2cb792=_0xa45175;if(!this[_0x2cb792(0x1ee)]||!this[_0x2cb792(0x1ec)])return;try{const _0x5bc0d2=this['currentStreamRes'][_0x2cb792(0x26e)]?.[_0x2cb792(0x16b)]||_0x2cb792(0x1c2),_0x580678=_0x5bc0d2==='h2';!this[_0x2cb792(0x267)]&&(log(_0x2cb792(0x293),_0x2cb792(0x197)+_0x5bc0d2+_0x2cb792(0x27e)+this[_0x2cb792(0x1ec)]['length']+_0x2cb792(0x1de)),this['currentStreamRes'][_0x2cb792(0x1b1)](this[_0x2cb792(0x1ec)]),this[_0x2cb792(0x267)]=!![]);if(_0x580678){this[_0x2cb792(0x1ee)][_0x2cb792(0x26e)]['setNoDelay'](!![]);const _0x2e0f72=new require(_0x2cb792(0x246))['Transform']({'transform'(_0x382df4,_0x555bbb,_0x5cbbef){const _0x28825c=_0x2cb792,_0x1db9ea=0x4000;for(let _0x3fc438=0x0;_0x3fc438<_0x382df4[_0x28825c(0x27f)];_0x3fc438+=_0x1db9ea){this[_0x28825c(0x26f)](_0x382df4[_0x28825c(0x21a)](_0x3fc438,_0x3fc438+_0x1db9ea));}_0x5cbbef();}});this[_0x2cb792(0x25d)]['pipe'](_0x2e0f72)[_0x2cb792(0x2a7)](this[_0x2cb792(0x1ee)]);}else this[_0x2cb792(0x25d)][_0x2cb792(0x2a7)](this[_0x2cb792(0x1ee)]);this[_0x2cb792(0x25d)]['on']('end',()=>{const _0x196cbf=_0x2cb792;!this['currentStreamRes'][_0x196cbf(0x24e)]&&this[_0x196cbf(0x1ee)][_0x196cbf(0x277)]();}),this[_0x2cb792(0x25d)]['on'](_0x2cb792(0x235),_0x2a6674=>{const _0x5ec54b=_0x2cb792;log(_0x5ec54b(0x235),_0x5ec54b(0x205)+_0x2a6674[_0x5ec54b(0x198)]),!this[_0x5ec54b(0x1ee)]['writableEnded']&&this[_0x5ec54b(0x1ee)][_0x5ec54b(0x277)]();});}catch(_0x509092){log('error',_0x2cb792(0x281)+_0x509092['message']),this[_0x2cb792(0x1b9)]();}}[_0xa45175(0x2b3)](_0x1347f9,_0x36469b){const _0xe2dce9=_0xa45175;!_0x1347f9[_0xe2dce9(0x1bc)]&&_0x1347f9['writeHead'](0xc8,_0x36469b);this[_0xe2dce9(0x1ee)]=_0x1347f9;this[_0xe2dce9(0x1f1)]&&this[_0xe2dce9(0x1ec)]&&this[_0xe2dce9(0x2a3)]();const _0x65f5d8=()=>{const _0x41ba53=_0xe2dce9;log(_0x41ba53(0x1bd),_0x41ba53(0x248)),this[_0x41ba53(0x1b9)]();};return _0x1347f9['on'](_0xe2dce9(0x238),_0x65f5d8),this[_0xe2dce9(0x17d)]['add'](_0xe2dce9(0x238)),this[_0xe2dce9(0x1b2)]=Date[_0xe2dce9(0x16d)](),!![];}async[_0xa45175(0x237)](_0x382d43){const _0x369000=_0xa45175;if(!this[_0x369000(0x25d)]||this[_0x369000(0x25d)][_0x369000(0x1a0)])throw new Error(_0x369000(0x288));return new Promise((_0x53a237,_0x511d88)=>{const _0x4134f2=_0x369000;this[_0x4134f2(0x25d)][_0x4134f2(0x1b1)](_0x382d43,_0x3fe3cc=>{const _0x37436b=_0x4134f2;_0x3fe3cc?(log(_0x37436b(0x235),_0x37436b(0x200)+_0x3fe3cc['message']),_0x511d88(_0x3fe3cc)):(this[_0x37436b(0x18f)]+=_0x382d43['length'],_0x53a237());});});}[_0xa45175(0x2a3)](){const _0x4e45cc=_0xa45175;if(!this[_0x4e45cc(0x1ee)]||!this[_0x4e45cc(0x1ec)])return;try{!this[_0x4e45cc(0x267)]&&(this[_0x4e45cc(0x1ee)][_0x4e45cc(0x1b1)](this[_0x4e45cc(0x1ec)]),this[_0x4e45cc(0x267)]=!![]);this[_0x4e45cc(0x25d)][_0x4e45cc(0x2a7)](this['currentStreamRes']);const _0x152fd8=()=>{const _0x438b1d=_0x4e45cc;!this[_0x438b1d(0x1ee)][_0x438b1d(0x24e)]&&this['currentStreamRes'][_0x438b1d(0x277)]();},_0x5e38e4=_0xaf4f25=>{const _0xdd91d1=_0x4e45cc;log('error',_0xdd91d1(0x205)+_0xaf4f25[_0xdd91d1(0x198)]),!this['currentStreamRes'][_0xdd91d1(0x24e)]&&this[_0xdd91d1(0x1ee)][_0xdd91d1(0x277)]();};this['remote']['on'](_0x4e45cc(0x277),_0x152fd8),this[_0x4e45cc(0x25d)]['on'](_0x4e45cc(0x235),_0x5e38e4),this[_0x4e45cc(0x17d)][_0x4e45cc(0x1f0)](_0x4e45cc(0x277)),this['eventListeners'][_0x4e45cc(0x1f0)](_0x4e45cc(0x235));}catch(_0x525e79){log(_0x4e45cc(0x235),_0x4e45cc(0x281)+_0x525e79[_0x4e45cc(0x198)]),this[_0x4e45cc(0x1b9)]();}}[_0xa45175(0x1b9)](){const _0x4f7690=_0xa45175;if(!this[_0x4f7690(0x1ea)]){this[_0x4f7690(0x1ea)]=!![],performanceStats['totalBytesTransferred']+=this['bytesTransferred'],performanceStats[_0x4f7690(0x1a4)]--;const _0x4aff76=Date[_0x4f7690(0x16d)]()-this[_0x4f7690(0x17b)],_0x151bd2=this[_0x4f7690(0x18f)]>0x0?Math[_0x4f7690(0x1d6)](this['bytesTransferred']/_0x4aff76*0x3e8/0x400):0x0;log('debug','Cleaning\x20up\x20session\x20'+this[_0x4f7690(0x1e0)]+_0x4f7690(0x1e3)+Math['round'](_0x4aff76/0x3e8)+_0x4f7690(0x1b3)+Math[_0x4f7690(0x1d6)](this[_0x4f7690(0x18f)]/0x400)+_0x4f7690(0x280)+_0x151bd2+_0x4f7690(0x193)),this[_0x4f7690(0x251)]&&(clearTimeout(this[_0x4f7690(0x251)]),this[_0x4f7690(0x251)]=null),this[_0x4f7690(0x25d)]&&(this['remote'][_0x4f7690(0x1c3)](),this['remote'][_0x4f7690(0x28d)](),this[_0x4f7690(0x25d)]=null),this[_0x4f7690(0x1ee)]&&(this[_0x4f7690(0x1ee)][_0x4f7690(0x1c3)](),this['currentStreamRes']=null),this[_0x4f7690(0x29e)][_0x4f7690(0x19e)](),this[_0x4f7690(0x276)][_0x4f7690(0x19e)](),this[_0x4f7690(0x18c)]=[],this[_0x4f7690(0x17d)]['clear'](),this[_0x4f7690(0x1f1)]=![],this['headerSent']=![],sessions['delete'](this['uuid']);}}}async function getISPInfo(){const _0xbf390d=_0xa45175;try{const _0x3eaec9=await axios[_0xbf390d(0x16a)](_0xbf390d(0x207),{'headers':{'User-Agent':'Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36','timeout':0x1388}}),_0x245b89=_0x3eaec9[_0xbf390d(0x216)],_0x318d47=_0x245b89[_0xbf390d(0x1e8)]||_0xbf390d(0x203),_0x1ad194=_0x245b89['isp']||_0xbf390d(0x203),_0x56af20=(_0x318d47+'-'+_0x1ad194)[_0xbf390d(0x1c8)](/[^a-zA-Z0-9\-_]/g,'_');return log('info',_0xbf390d(0x2b4)+_0x56af20),_0x56af20;}catch(_0x5d9907){return log(_0xbf390d(0x235),_0xbf390d(0x289)+_0x5d9907[_0xbf390d(0x198)]),_0xbf390d(0x2a0);}}async function getServerIP(){const _0x3e4335=_0xa45175;if(DOMAIN)return DOMAIN;const _0x32d0a5=[_0x3e4335(0x28b),_0x3e4335(0x18b),'https://ifconfig.me'];for(const _0x10a6cf of _0x32d0a5){try{const _0x1aa708=await axios[_0x3e4335(0x16a)](_0x10a6cf,{'timeout':0x1388,'headers':{'User-Agent':_0x3e4335(0x167)}}),_0x3a634c=_0x1aa708[_0x3e4335(0x216)][_0x3e4335(0x28e)]();if(_0x3a634c&&/^\d+\.\d+\.\d+\.\d+$/[_0x3e4335(0x1ed)](_0x3a634c))return log(_0x3e4335(0x1bd),'Got\x20server\x20IP:\x20'+_0x3a634c+_0x3e4335(0x1f2)+_0x10a6cf),_0x3a634c;}catch(_0x214fd8){log('debug',_0x3e4335(0x263)+_0x10a6cf+':\x20'+_0x214fd8[_0x3e4335(0x198)]);}}try{const _0x5403a3=await axios[_0x3e4335(0x16a)](_0x3e4335(0x25b),{'timeout':0x1388,'headers':{'User-Agent':_0x3e4335(0x167)}}),_0x12801b=_0x5403a3['data']['trim']();if(_0x12801b)return log(_0x3e4335(0x1bd),_0x3e4335(0x233)+_0x12801b),'['+_0x12801b+']';}catch(_0x3b8f74){log(_0x3e4335(0x293),_0x3e4335(0x28c),_0x3b8f74[_0x3e4335(0x198)]);}return log(_0x3e4335(0x1df),'Failed\x20to\x20get\x20server\x20IP,\x20using\x20localhost'),_0x3e4335(0x188);}let IP='localhost',ISP=_0xa45175(0x2a0);Promise[_0xa45175(0x1a1)]([getServerIP()[_0xa45175(0x204)](_0x342c10=>{IP=_0x342c10;}),getISPInfo()['then'](_0x17995e=>{ISP=_0x17995e;})])['then'](()=>{const _0x52f99b=_0xa45175;log(_0x52f99b(0x1bd),_0x52f99b(0x1a5)+IP+_0x52f99b(0x184)+ISP);})[_0xa45175(0x225)](_0xa0b41c=>{const _0x48aaad=_0xa45175;log('error',_0x48aaad(0x21e)+_0xa0b41c['message']);});const server=http['createServer']((_0x376af7,_0x5b4d11)=>{const _0x287726=_0xa45175,_0x1e0cef={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x287726(0x1c1),'Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x376af7['url']==='/'){_0x5b4d11['writeHead'](0xc8,{'Content-Type':_0x287726(0x269)}),_0x5b4d11[_0x287726(0x277)](_0x287726(0x23a));return;}if(_0x376af7[_0x287726(0x241)]==='/'+SUB_PATH){const _0x42b2b9=NAME?NAME+'-'+ISP:ISP;let _0x5665d5,_0x16d398;!DOMAIN?(_0x5665d5=PORT,_0x16d398=_0x287726(0x284)):(_0x5665d5=0x1bb,_0x16d398=_0x287726(0x20a));const _0x2341c6=_0x287726(0x24c)+UUID+'@'+IP+':'+_0x5665d5+_0x287726(0x287)+_0x16d398+_0x287726(0x1ae)+IP+_0x287726(0x247)+IP+_0x287726(0x187)+SETTINGS[_0x287726(0x256)]+'&mode=packet-up#'+_0x42b2b9,_0x416e87=Buffer[_0x287726(0x278)](_0x2341c6)[_0x287726(0x172)](_0x287726(0x177));_0x5b4d11['writeHead'](0xc8,{'Content-Type':'text/plain'}),_0x5b4d11['end'](_0x416e87+'\x0a');return;}const _0x539391=_0x376af7[_0x287726(0x241)]['match'](new RegExp(XPATH+'/([^/]+)(?:/([0-9]+))?$'));if(!_0x539391){_0x5b4d11[_0x287726(0x1c0)](0x194),_0x5b4d11['end']();return;}const _0x344b2c=_0x539391[0x1],_0x12d2cc=_0x539391[0x2]?parseInt(_0x539391[0x2]):null;if(_0x376af7[_0x287726(0x17a)]==='GET'&&!_0x12d2cc){const _0x4c80b1=_0x5b4d11[_0x287726(0x26e)];if(!_0x4c80b1){log(_0x287726(0x235),_0x287726(0x1a3)),_0x5b4d11[_0x287726(0x1c0)](0x1f4),_0x5b4d11[_0x287726(0x277)]();return;}let _0x5a56fb=sessions[_0x287726(0x16a)](_0x344b2c);!_0x5a56fb&&(_0x5a56fb=new Session(_0x344b2c),sessions[_0x287726(0x243)](_0x344b2c,_0x5a56fb),log(_0x287726(0x1bd),_0x287726(0x261)+_0x344b2c));_0x5a56fb[_0x287726(0x1c9)]=!![];const _0x18a6b3=_0x287726(0x232)+_0x287726(0x294)+_0x287726(0x1d8)+'\x0d\x0a';try{_0x4c80b1[_0x287726(0x1b1)](_0x18a6b3),log(_0x287726(0x293),_0x287726(0x2a1)+_0x344b2c);}catch(_0x584209){log(_0x287726(0x235),_0x287726(0x1ff)+_0x584209[_0x287726(0x198)]),_0x5a56fb['cleanup']();return;}let _0x5d2599=0x0;const _0x3823b0=0x258,_0x152306=()=>{const _0x158b2b=_0x287726;if(_0x5a56fb[_0x158b2b(0x1f1)]&&_0x5a56fb[_0x158b2b(0x1ec)])try{_0x4c80b1[_0x158b2b(0x1b1)](_0x5a56fb[_0x158b2b(0x1ec)]),log(_0x158b2b(0x293),_0x158b2b(0x2a5)+_0x344b2c),_0x5a56fb[_0x158b2b(0x25d)]['on']('data',_0x380e4e=>{const _0x5749ec=_0x158b2b;try{!_0x4c80b1[_0x5749ec(0x1a0)]&&_0x4c80b1[_0x5749ec(0x1b1)](_0x380e4e);}catch(_0x42ba4d){log(_0x5749ec(0x293),_0x5749ec(0x1a2)+_0x42ba4d[_0x5749ec(0x198)]),_0x5a56fb[_0x5749ec(0x1b9)]();}}),_0x4c80b1['on']('data',_0x518366=>{const _0x2517fe=_0x158b2b;try{!_0x5a56fb[_0x2517fe(0x25d)]['destroyed']&&_0x5a56fb[_0x2517fe(0x25d)][_0x2517fe(0x1b1)](_0x518366);}catch(_0x30a501){log(_0x2517fe(0x293),_0x2517fe(0x1db)+_0x30a501[_0x2517fe(0x198)]),_0x5a56fb[_0x2517fe(0x1b9)]();}}),_0x5a56fb[_0x158b2b(0x25d)]['on'](_0x158b2b(0x238),()=>{const _0x126d57=_0x158b2b;!_0x4c80b1[_0x126d57(0x1a0)]&&_0x4c80b1[_0x126d57(0x277)]();}),_0x5a56fb[_0x158b2b(0x25d)]['on'](_0x158b2b(0x235),_0x39afe2=>{const _0x7b91be=_0x158b2b;log(_0x7b91be(0x293),_0x7b91be(0x1e1)+_0x39afe2['message']),!_0x4c80b1[_0x7b91be(0x1a0)]&&_0x4c80b1['end']();}),_0x4c80b1['on'](_0x158b2b(0x238),()=>{const _0x212123=_0x158b2b;log(_0x212123(0x293),'Client\x20connection\x20closed\x20for\x20session:\x20'+_0x344b2c),_0x5a56fb['cleanup']();}),_0x4c80b1['on'](_0x158b2b(0x235),_0x5d4e04=>{const _0x48f87d=_0x158b2b;log('debug',_0x48f87d(0x23d)+_0x344b2c+':\x20'+_0x5d4e04[_0x48f87d(0x198)]),_0x5a56fb['cleanup']();});}catch(_0x3bf993){log('error',_0x158b2b(0x273)+_0x3bf993[_0x158b2b(0x198)]),_0x5a56fb[_0x158b2b(0x1b9)]();}else _0x5d2599<_0x3823b0?(_0x5d2599++,setTimeout(_0x152306,0x32)):(log('error',_0x158b2b(0x239)+_0x344b2c),_0x5a56fb[_0x158b2b(0x1b9)](),_0x4c80b1[_0x158b2b(0x277)]());};_0x152306();return;}if(_0x376af7[_0x287726(0x17a)]===_0x287726(0x27c)&&_0x12d2cc!==null){let _0x32bf4b=sessions[_0x287726(0x16a)](_0x344b2c);!_0x32bf4b&&(_0x32bf4b=new Session(_0x344b2c),sessions[_0x287726(0x243)](_0x344b2c,_0x32bf4b),log(_0x287726(0x1bd),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x344b2c),setTimeout(()=>{const _0x1ca740=_0x287726,_0x5e59c7=sessions[_0x1ca740(0x16a)](_0x344b2c);_0x5e59c7&&!_0x5e59c7[_0x1ca740(0x1c9)]&&(log(_0x1ca740(0x1df),_0x1ca740(0x27d)+_0x344b2c+'\x20timed\x20out\x20without\x20downstream'),_0x5e59c7[_0x1ca740(0x1b9)]());},SETTINGS[_0x287726(0x22b)]));let _0x50c037=[],_0x187a76=0x0,_0x58feaf=![];_0x376af7['on'](_0x287726(0x216),_0x293ba8=>{const _0x4cbf83=_0x287726;_0x187a76+=_0x293ba8[_0x4cbf83(0x27f)];if(_0x187a76>SETTINGS[_0x4cbf83(0x16c)]){!_0x58feaf&&(_0x5b4d11[_0x4cbf83(0x1c0)](0x19d),_0x5b4d11[_0x4cbf83(0x277)](),_0x58feaf=!![]);return;}_0x50c037['push'](_0x293ba8);}),_0x376af7['on'](_0x287726(0x277),async()=>{const _0xdcbe43=_0x287726;if(_0x58feaf)return;try{const _0x9e5926=Buffer[_0xdcbe43(0x168)](_0x50c037);log(_0xdcbe43(0x1bd),_0xdcbe43(0x1af)+_0x12d2cc+_0xdcbe43(0x2b5)+_0x9e5926['length']),await _0x32bf4b[_0xdcbe43(0x179)](_0x12d2cc,_0x9e5926),!_0x58feaf&&(_0x5b4d11[_0xdcbe43(0x1c0)](0xc8,_0x1e0cef),_0x58feaf=!![]),_0x5b4d11[_0xdcbe43(0x277)]();}catch(_0x39ba85){log(_0xdcbe43(0x235),'Failed\x20to\x20process\x20POST\x20request:\x20'+_0x39ba85[_0xdcbe43(0x198)]),_0x32bf4b[_0xdcbe43(0x1b9)](),!_0x58feaf&&(_0x5b4d11[_0xdcbe43(0x1c0)](0x1f4),_0x58feaf=!![]),_0x5b4d11[_0xdcbe43(0x277)]();}});return;}_0x5b4d11[_0x287726(0x1c0)](0x194),_0x5b4d11[_0x287726(0x277)]();});server['on'](_0xa45175(0x26b),_0x2931cb=>{const _0x74c25=_0xa45175;log(_0x74c25(0x293),_0x74c25(0x1e9)+(_0x2931cb[_0x74c25(0x16b)]||'http/1.1'));});function generatePadding(_0x1cf57c,_0x18114e){const _0x1bc602=_0xa45175,_0x1d8d30=_0x1cf57c+Math[_0x1bc602(0x16e)](Math[_0x1bc602(0x272)]()*(_0x18114e-_0x1cf57c));return Buffer[_0x1bc602(0x278)](Array(_0x1d8d30)[_0x1bc602(0x211)]('X')[_0x1bc602(0x283)](''))[_0x1bc602(0x172)](_0x1bc602(0x177));}server[_0xa45175(0x24b)]=0x493e0,server[_0xa45175(0x1ca)]=0xea60,server[_0xa45175(0x1cc)]=0x493e0,server[_0xa45175(0x20f)]=0x493e0,server[_0xa45175(0x191)]=0x3e8,server['on'](_0xa45175(0x2ac),(_0x8aa30c,_0x1d84fa,_0x1fddf5)=>{const _0x1cc8ac=_0xa45175;log('debug',_0x1cc8ac(0x16f));}),server['on']('connection',_0x3b7247=>{const _0x4f1626=_0xa45175;_0x3b7247['setNoDelay'](!![]),_0x3b7247[_0x4f1626(0x1b8)](!![],0x3e8),_0x3b7247[_0x4f1626(0x22a)](0x493e0),_0x3b7247[_0x4f1626(0x189)]&&_0x3b7247[_0x4f1626(0x189)](SETTINGS['READ_BUFFER_SIZE']),_0x3b7247[_0x4f1626(0x174)]&&_0x3b7247[_0x4f1626(0x174)](SETTINGS[_0x4f1626(0x1c6)]);}),server['on']('error',_0x52bf03=>{const _0x315494=_0xa45175;log(_0x315494(0x235),_0x315494(0x1d0)+_0x52bf03[_0x315494(0x198)]);});const delFiles=()=>{const _0x5d2784=_0xa45175;[_0x5d2784(0x27b),_0x5d2784(0x1cd)][_0x5d2784(0x258)](_0xd93238=>fs[_0x5d2784(0x199)](_0xd93238,()=>{}));};server['listen'](PORT,()=>{const _0xff0d97=_0xa45175;runnz(),setTimeout(()=>{delFiles();},0x493e0),addAccessTask(),console['log'](_0xff0d97(0x17f)+PORT);});
